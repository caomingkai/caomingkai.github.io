<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.0.6" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.6">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.6">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.6">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.6" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.0.6',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="All-trade Jack, loves full-stack">
<meta property="og:type" content="website">
<meta property="og:title" content="CMK">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="CMK">
<meta property="og:description" content="All-trade Jack, loves full-stack">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CMK">
<meta name="twitter:description" content="All-trade Jack, loves full-stack">






  <link rel="canonical" href="http://yoursite.com/page/2/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>CMK</title>
  




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-116541729-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116541729-1');
</script>






  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-right 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> 

<div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">CMK</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Let's create something!</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
          
  <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Home</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />Categories</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />Tags</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archives</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />About</a>
</li>

      

      
    </ul>
  

  
    

    
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
    

  


  

  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/01/Event-Emitter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mingkai Cao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sea.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CMK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/01/Event-Emitter/" itemprop="url">Event Emitter</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-10-01T20:21:44-07:00">2018-10-01</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Full-stack/" itemprop="url" rel="index"><span itemprop="name">Full stack</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/10/01/Event-Emitter/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/10/01/Event-Emitter/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="I-What-is-an-Event-Emitter"><a href="#I-What-is-an-Event-Emitter" class="headerlink" title="I. What is an Event Emitter?"></a>I. What is an Event Emitter?</h4><p>An <code>event emitter</code> is a <strong>utility object</strong>, which can be used to emit event, which can be subscribed by as many functions as we can. </p>
<ol>
<li><p>It is an event manager, manages differents event and its subscribers.</p>
</li>
<li><p>Also, we can see it as the <code>Redux</code>, which also dispatches(emits) actions, and handled by its reducers.</p>
</li>
<li>It widely used at Node.js ( asynchronous event-driven architecture)<ul>
<li>certain kind of objects call emitters periodically to emit events that cause listener objects to be called.</li>
<li>when a request comes requesting some resource, Node.js will register the subscriber: <code>responseToThisRequest()</code> on event: <code>thisTypeDataDone</code>. When data is obtained, will call <code>emitter.emit( thisTypeDataDone )</code>, to call the <code>responseToThisRequest()</code> corresponding all the requests.</li>
</ul>
</li>
</ol>
<h4 id="II-Why-and-when-do-we-need-it"><a href="#II-Why-and-when-do-we-need-it" class="headerlink" title="II. Why and when do we need it?"></a>II. Why and when do we need it?</h4><blockquote>
<p>Whenever it makes sense for code to SUBSCRIBE to something rather than get a callback from something</p>
<p><a href="https://stackoverflow.com/questions/38881170/when-should-i-use-eventemitter" target="_blank" rel="noopener">https://stackoverflow.com/questions/38881170/when-should-i-use-eventemitter</a></p>
</blockquote>
<p>If when a certain event happens, we have to deal many type of manipulation for that event‚Äôs result, then it is better to use the event emitter pattern. </p>
<p>Instead put all functions inside an event callback, we subscribe all the function to that event, when the event happens, we emit the event!</p>
<h4 id="III-How-to-use-it"><a href="#III-How-to-use-it" class="headerlink" title="III. How to use it?"></a>III. How to use it?</h4><p><strong>[Good Link]:</strong> <a href="https://netbasal.com/javascript-the-magic-behind-event-emitter-cce3abcbcef9" target="_blank" rel="noopener">https://netbasal.com/javascript-the-magic-behind-event-emitter-cce3abcbcef9</a></p>
<p><strong>[Note]:  when pass in the callback function, we use arrow function, which already bind ‚Äòthis‚Äô to the function, so that when the function be called, it knows what value it will update</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> input = <span class="built_in">document</span>.querySelector(<span class="string">'input[type="text"]'</span>);</span><br><span class="line"><span class="keyword">let</span> button = <span class="built_in">document</span>.querySelector(<span class="string">'button'</span>);</span><br><span class="line"><span class="keyword">let</span> h1 = <span class="built_in">document</span>.querySelector(<span class="string">'h1'</span>);</span><br><span class="line"></span><br><span class="line">button.addEventListener(<span class="string">'click'</span>, () =&gt; &#123;</span><br><span class="line">  emitter.emit(<span class="string">'event:name-changed'</span>, &#123;<span class="attr">name</span>: input.value&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> emitter = <span class="keyword">new</span> EventEmitter();</span><br><span class="line">emitter.subscribe(<span class="string">'event:name-changed'</span>, data =&gt; &#123;</span><br><span class="line">  h1.innerHTML = <span class="string">`Your name is: <span class="subst">$&#123;data.name&#125;</span>`</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ol>
<li><p>create an emitter util object</p>
</li>
<li><p>subscribe the desired callback function, using <code>emitter.subscribe(event, function.bind(this))</code></p>
</li>
<li><p>call <code>emitter.emit()</code> when the event happen</p>
</li>
</ol>
<h4 id="IV-Write-one"><a href="#IV-Write-one" class="headerlink" title="IV. Write one!"></a>IV. Write one!</h4><ol>
<li><strong><u>object:</u></strong> we need an object (utility object)</li>
<li><u><strong>data structure:</strong></u> inside it, we need a data structure to store the <code>event</code> and its <code>subscribers</code>(callbacks)</li>
<li><strong><u>methods:</u></strong>  all the methods<ul>
<li><code>subscribe(event, callback)</code>: we need the return value to be an <code>unsubscribe()</code>, so we won‚Äôt result in the memory leak!</li>
<li><code>emit()</code></li>
</ul>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EventEmitter</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">this</span>.events = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  on(event, listener) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>.events[event] !== <span class="string">'object'</span>) &#123;</span><br><span class="line">          <span class="keyword">this</span>.events[event] = [];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">this</span>.events[event].push(listener);</span><br><span class="line">      <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.removeListener(event, listener);</span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  removeListener(event, listener) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>.events[event] === <span class="string">'object'</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> idx = <span class="keyword">this</span>.events[event].indexOf(listener);</span><br><span class="line">        <span class="keyword">if</span> (idx &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">          <span class="keyword">this</span>.events[event].splice(idx, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  emit(event, ...args) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>.events[event] === <span class="string">'object'</span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>.events[event].forEach(</span><br><span class="line">        listener =&gt; &#123;<span class="keyword">if</span>(<span class="keyword">typeof</span> listener === <span class="string">'function'</span>) listener.apply(<span class="literal">null</span>, args)&#125;</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// register a wrapper function containing the listener on this event,</span></span><br><span class="line">  <span class="comment">// when get executed, </span></span><br><span class="line">  <span class="comment">//   - first remove it on this event;</span></span><br><span class="line">  <span class="comment">//   - then execute real listener</span></span><br><span class="line">  once(event, listener) &#123;</span><br><span class="line">    <span class="keyword">const</span> remove = <span class="keyword">this</span>.on(event, (...args) =&gt; &#123;</span><br><span class="line">        remove();</span><br><span class="line">        listener.apply(<span class="literal">null</span>, args);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> emitter = <span class="keyword">new</span> EventEmitter()</span><br><span class="line"><span class="comment">// Test 1: invalid callback function</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"Test 1: Nothing should be print out"</span>)</span><br><span class="line">emitter.on(<span class="string">"a"</span>, <span class="number">1</span>);</span><br><span class="line">emitter.emit(<span class="string">"a"</span>);</span><br><span class="line"><span class="built_in">console</span>.log()</span><br><span class="line"></span><br><span class="line"><span class="comment">// Test 2: add mutilple callback function to an event</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"Test 2: callback 1, 2, 3"</span>)</span><br><span class="line">emitter.on(<span class="string">"b"</span>, ()=&gt;&#123;<span class="built_in">console</span>.log(<span class="string">"event b callback 1"</span>)&#125;);</span><br><span class="line">emitter.on(<span class="string">"b"</span>, ()=&gt;&#123;<span class="built_in">console</span>.log(<span class="string">"event b callback 2"</span>)&#125;);</span><br><span class="line"><span class="keyword">let</span> off1 = emitter.on(<span class="string">"b"</span>, ()=&gt;&#123;<span class="built_in">console</span>.log(<span class="string">"event b callback 3"</span>)&#125;);</span><br><span class="line">emitter.emit(<span class="string">"b"</span>);</span><br><span class="line"><span class="built_in">console</span>.log()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Test 3: unsubscribe one callback from an event queue</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"Test 3: callback 1, 2"</span>)</span><br><span class="line">off1();</span><br><span class="line">emitter.emit(<span class="string">"b"</span>); </span><br><span class="line"><span class="built_in">console</span>.log()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Test 4: subscribe other event &amp; callbacks at the same time</span></span><br><span class="line"><span class="keyword">let</span> data = &#123;<span class="attr">digit</span>: <span class="number">1</span>&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"Test 4:  digit should be 11 &amp; 14 "</span>)</span><br><span class="line">emitter.on(<span class="string">"c"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123; data.digit+=<span class="number">1</span> &#125;);</span><br><span class="line">emitter.on(<span class="string">"c"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123; data.digit+=<span class="number">2</span> &#125;);</span><br><span class="line">emitter.on(<span class="string">"d"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123; data.digit+=<span class="number">3</span> &#125;);;</span><br><span class="line"><span class="keyword">let</span> off2 = emitter.on(<span class="string">"d"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123; data.digit+=<span class="number">4</span> &#125;);</span><br><span class="line"></span><br><span class="line">emitter.emit(<span class="string">"c"</span>, data); </span><br><span class="line">emitter.emit(<span class="string">"d"</span>, data);  </span><br><span class="line"><span class="built_in">console</span>.log(data.digit)</span><br><span class="line">      </span><br><span class="line">off2()</span><br><span class="line">emitter.emit(<span class="string">"d"</span>, data);  </span><br><span class="line"><span class="built_in">console</span>.log(data.digit)</span><br><span class="line"><span class="built_in">console</span>.log()</span><br><span class="line">      </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Test 5: subscribe other event &amp; callbacks</span></span><br><span class="line"><span class="keyword">let</span> data2 = &#123;<span class="attr">digit</span>: <span class="number">5</span>&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"Test 5: digit should be 11"</span>)</span><br><span class="line">emitter.emit(<span class="string">"d"</span>, data2 ); </span><br><span class="line">emitter.emit(<span class="string">"c"</span>, data2 ); </span><br><span class="line"><span class="built_in">console</span>.log(data2.digit)   </span><br><span class="line"><span class="built_in">console</span>.log()</span><br><span class="line"></span><br><span class="line"><span class="comment">// Test 6: test once</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"Test 6: should only print once"</span>)</span><br><span class="line">emitter.once(<span class="string">"test 6"</span>, ()=&gt;&#123;<span class="built_in">console</span>.log(<span class="string">"should only print once"</span>)&#125; ); </span><br><span class="line">emitter.emit(<span class="string">"test 6"</span> ); </span><br><span class="line">emitter.emit(<span class="string">"test 6"</span> ); </span><br><span class="line">emitter.emit(<span class="string">"test 6"</span> ); </span><br><span class="line"><span class="built_in">console</span>.log()</span><br></pre></td></tr></table></figure>
<p><strong><em>FaceBook interview version</em></strong><br><a href="https://gist.github.com/kutyel/7d8f204a347840a6ee7220743957e504" target="_blank" rel="noopener">https://gist.github.com/kutyel/7d8f204a347840a6ee7220743957e504</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Create an event emitter that goes like this</span></span><br><span class="line"><span class="comment"> * emitter = new Emitter();</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Allows you to subscribe to some event</span></span><br><span class="line"><span class="comment"> * sub1 = emitter.subscribe('function_name', callback1);</span></span><br><span class="line"><span class="comment"> * (you can have multiple callbacks to the same event)</span></span><br><span class="line"><span class="comment"> * sub2 = emitter.subscribe('function_name', callback2);</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * You can emit the event you want with this api</span></span><br><span class="line"><span class="comment"> * (you can receive 'n' number of arguments)</span></span><br><span class="line"><span class="comment"> * sub1.emit('function_name', foo, bar);</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * And allows you to release the subscription like this</span></span><br><span class="line"><span class="comment"> * (but you should be able to still emit from sub2)</span></span><br><span class="line"><span class="comment"> * sub1.release();</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// facebook.js</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Emitter</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(events = &#123;&#125;) &#123;</span><br><span class="line">    <span class="keyword">this</span>.events = events</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  subscribe(name, cb) &#123;</span><br><span class="line">    (<span class="keyword">this</span>.events[name] || (<span class="keyword">this</span>.events[name] = [])).push(cb)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      release: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.events[name] &amp;&amp;</span><br><span class="line">        <span class="keyword">this</span>.events[name].splice(<span class="keyword">this</span>.events[name].indexOf(cb) &gt;&gt;&gt; <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  emit(name, ...args) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">this</span>.events[name] || []).map(<span class="function"><span class="params">fn</span> =&gt;</span> fn(...args))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Emitter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// test.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> expect = <span class="built_in">require</span>(<span class="string">'expect'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Emitter = <span class="built_in">require</span>(<span class="string">'./facebook'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Step 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> test = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> emitter = <span class="keyword">new</span> Emitter()</span><br><span class="line"></span><br><span class="line">emitter.emit(<span class="string">'sum'</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">expect(test).toBe(<span class="number">0</span>) <span class="comment">// should trigger nothing</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sub1 = emitter.subscribe(<span class="string">'sum'</span>, num =&gt; (test = test + num))</span><br><span class="line"></span><br><span class="line">emitter.emit(<span class="string">'sum'</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">expect(test).toBe(<span class="number">1</span>) <span class="comment">// should trigger 1 callback</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sub2 = emitter.subscribe(<span class="string">'sum'</span>, num =&gt; (test = test * num))</span><br><span class="line"></span><br><span class="line">emitter.emit(<span class="string">'sum'</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">expect(test).toBe(<span class="number">6</span>) <span class="comment">// should trigger 2 callbacks</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Step 2</span></span><br><span class="line"></span><br><span class="line">sub1.release()</span><br><span class="line"></span><br><span class="line">emitter.emit(<span class="string">'sum'</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">expect(test).toBe(<span class="number">18</span>) <span class="comment">// should trigger 1 callback</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Step 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myEvent1 = emitter.subscribe(<span class="string">'myEvent'</span>, () =&gt; <span class="number">1</span>)</span><br><span class="line"><span class="keyword">const</span> myEvent2 = emitter.subscribe(<span class="string">'myEvent'</span>, () =&gt; <span class="number">2</span>)</span><br><span class="line"><span class="keyword">const</span> myEvent3 = emitter.subscribe(<span class="string">'myEvent'</span>, () =&gt; <span class="literal">true</span>)</span><br><span class="line"><span class="keyword">const</span> result = emitter.emit(<span class="string">'myEvent'</span>)</span><br><span class="line"></span><br><span class="line">expect(result).toEqual([<span class="number">1</span>, <span class="number">2</span>, <span class="literal">true</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.info(<span class="string">'You passed the test!!! üëèüèº üëèüèº üëèüèº'</span>)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/05/this-arrow-function/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mingkai Cao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sea.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CMK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/09/05/this-arrow-function/" itemprop="url">'this' & arrow function</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-09-05T21:51:55-07:00">2018-09-05</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Full-stack/" itemprop="url" rel="index"><span itemprop="name">Full stack</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/09/05/this-arrow-function/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/09/05/this-arrow-function/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="I-this-in-function"><a href="#I-this-in-function" class="headerlink" title="I. this in function"></a>I. <code>this</code> in function</h2><ol>
<li><p><strong>what is <code>this</code> ?</strong></p>
<ul>
<li>all <strong><u>regular</u></strong> functions have <code>this</code> keyword</li>
<li><code>this</code> determines how a function is called <strong><u>on whom</u></strong>!</li>
</ul>
</li>
<li><p><strong><code>this</code> in global context</strong></p>
<ul>
<li><p><code>this</code> refers  gloabl object, no matter in strict mode or not</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// In web browsers, the window object is also the global object:</span><br><span class="line">console.log(this === window); // true</span><br><span class="line"></span><br><span class="line">a = 37;</span><br><span class="line">console.log(window.a); // 37</span><br><span class="line"></span><br><span class="line">this.b = &quot;MDN&quot;;</span><br><span class="line">console.log(window.b)  // &quot;MDN&quot;</span><br><span class="line">console.log(b)         // &quot;MDN&quot;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><u><strong><code>this</code> in function context [important]</strong></u></p>
<p>There are 7 cases that different function context results in different <code>this</code> reference;</p>
<blockquote>
<p><u>The value of <code>this</code></u> depend on how the function is called</p>
</blockquote>
<ol>
<li><p><code>this</code> in <strong><u>simple call</u></strong></p>
<ul>
<li><p>non-strict mode</p>
<p>if <code>this</code> is not set explicitly, it default to global object</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">this</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// In a browser:</span></span><br><span class="line">f1() === <span class="built_in">window</span>; <span class="comment">// true </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// In Node:</span></span><br><span class="line">f1() === global; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>strict mode</p>
<p>if <code>this</code> is not set explicitly, the value of <code>this</code> remains <code>undefined</code></p>
</li>
<li><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="meta">  'use strict'</span>; <span class="comment">// see strict mode</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f2() === <span class="literal">undefined</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>change the value of <code>this</code>, using <code>apply()</code> or <code>call()</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// An object can be passed as the first argument to call or apply and this will be bound to it.</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">a</span>: <span class="string">'Custom'</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This property is set on the global object</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="string">'Global'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">whatsThis</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.a;  <span class="comment">// The value of this is dependent on how the function is called</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">whatsThis();          <span class="comment">// 'Global'</span></span><br><span class="line">whatsThis.call(obj);  <span class="comment">// 'Custom'</span></span><br><span class="line">whatsThis.apply(obj); <span class="comment">// 'Custom'</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>this</code> in <strong><u><code>bind()</code> method</u></strong></p>
<ul>
<li><p>NOTE: <code>bind()</code> doesn‚Äôt change the orignal function, instead it return a <strong><u>new function</u></strong> with updated value of <code>this</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">this</span>.a; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> g = f.bind(&#123;<span class="attr">a</span>: <span class="string">'azerty'</span>&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(g()); <span class="comment">// azerty</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> h = g.bind(&#123;<span class="attr">a</span>: <span class="string">'yoo'</span>&#125;); <span class="comment">// bind only works once!</span></span><br><span class="line"><span class="built_in">console</span>.log(h()); <span class="comment">// azerty</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">a</span>: <span class="number">37</span>, <span class="attr">f</span>: f, <span class="attr">g</span>: g, <span class="attr">h</span>: h&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(o.a, o.f(), o.g(), o.h()); <span class="comment">// 37,37, azerty, azerty</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>this</code> in <u><strong>arrow function</strong></u></p>
<ul>
<li><p><code>this</code> cannot be changed, it default to the value of the <strong><u>enclosing lexical context</u></strong>‚Äòs <code>this</code></p>
</li>
<li><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> globalObject = <span class="keyword">this</span>;</span><br><span class="line"><span class="keyword">var</span> foo = <span class="function">(<span class="params">(</span>) =&gt;</span> <span class="keyword">this</span>);</span><br><span class="line"><span class="built_in">console</span>.log(foo() === globalObject); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>About <code>call()</code> &amp; <code>apply()</code></p>
<ul>
<li><p>if <code>this</code> arg is passed to call, bind, or apply on invocation of an arrow function it will be <strong><u>ignored</u></strong>.</p>
</li>
<li><p>the <code>thisArg</code> still works</p>
</li>
<li><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Call as a method of an object</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">func</span>: foo&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(obj.func() === globalObject); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Attempt to set this using call</span></span><br><span class="line"><span class="built_in">console</span>.log(foo.call(obj) === globalObject); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Attempt to set this using bind</span></span><br><span class="line">foo = foo.bind(obj);</span><br><span class="line"><span class="built_in">console</span>.log(foo() === globalObject); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p><strong><u>another example:</u></strong>  <code>this</code> of arrow function, directly depends on its enclosing context </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create obj with a method bar that returns a function that</span></span><br><span class="line"><span class="comment">// returns its this. The returned function is created as </span></span><br><span class="line"><span class="comment">// an arrow function, so its this is permanently bound to the</span></span><br><span class="line"><span class="comment">// this of its enclosing function. The value of bar can be set</span></span><br><span class="line"><span class="comment">// in the call, which in turn sets the value of the </span></span><br><span class="line"><span class="comment">// returned function.</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">bar</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">var</span> x = <span class="function">(<span class="params">(</span>) =&gt;</span> <span class="keyword">this</span>);</span><br><span class="line">                    <span class="keyword">return</span> x;</span><br><span class="line">                  &#125;</span><br><span class="line">          &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Call bar as a method of obj, setting its this to obj</span></span><br><span class="line"><span class="comment">// Assign a reference to the returned function to fn</span></span><br><span class="line"><span class="keyword">var</span> fn = obj.bar();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Call fn without setting this, would normally default</span></span><br><span class="line"><span class="comment">// to the global object or undefined in strict mode</span></span><br><span class="line"><span class="built_in">console</span>.log(fn() === obj); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// But caution if you reference the method of obj without calling it</span></span><br><span class="line"><span class="keyword">var</span> fn2 = obj.bar;</span><br><span class="line"><span class="comment">// Then calling the arrow function this is equals to window because it follows the this from bar.</span></span><br><span class="line"><span class="built_in">console</span>.log(fn2()() == <span class="built_in">window</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p><code>this</code> in <u><strong>object method</strong></u></p>
<ul>
<li><p>When a function is called as a method of an object, its <code>this</code> is set to <strong><u>the object</u></strong> the method is called on.</p>
</li>
<li><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">  prop: <span class="number">37</span>,</span><br><span class="line">  f: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.prop;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(o.f()); <span class="comment">// 37</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>this</code> on the object‚Äôs prototype chain</p>
<p>If the method is on an object‚Äôs prototype chain, <code>this</code> refers to the object the method was called on, as if the method were on the object.</p>
</li>
</ul>
</li>
<li><p><code>this</code> in <u><strong>constructor</strong></u></p>
<ul>
<li><p><code>this</code> is bound to the <strong><u>new object being constructed</u></strong></p>
</li>
<li><p><strong>#A#</strong>  if <code>constructor</code> doesn‚Äôt return: result of <code>new</code> will be the object bound to <code>this</code></p>
</li>
<li><p><strong>#B#</strong>  if <code>constructor</code> return an object: result of <code>new</code> will be the return value</p>
</li>
<li><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">C</span>(<span class="params"></span>) </span>&#123; <span class="keyword">this</span>.a = <span class="number">37</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> C();</span><br><span class="line"><span class="built_in">console</span>.log(o.a); <span class="comment">// 37</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">C2</span>(<span class="params"></span>) </span>&#123;   </span><br><span class="line">  <span class="keyword">this</span>.a = <span class="number">37</span>;</span><br><span class="line">  <span class="keyword">return</span> &#123;<span class="attr">a</span>: <span class="number">38</span>&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// if an object was returned during construction, then the new object that this was bound to simply gets discarded.</span></span><br><span class="line"></span><br><span class="line">o = <span class="keyword">new</span> C2();</span><br><span class="line"><span class="built_in">console</span>.log(o.a); <span class="comment">// 38</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>this</code> in <u><strong>DOM event handler</strong></u></p>
<ul>
<li><p><code>this</code> is set to the <strong><u>target element</u></strong> the event fired from</p>
</li>
<li><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// When called as a listener, turns the related element blue</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bluify</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Always true</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span> === e.currentTarget); </span><br><span class="line">  <span class="comment">// true when currentTarget and target are the same object</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span> === e.target);</span><br><span class="line">  <span class="keyword">this</span>.style.backgroundColor = <span class="string">'#A5D9F3'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get a list of every element in the document</span></span><br><span class="line"><span class="keyword">var</span> elements = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'*'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add bluify as a click listener so when the</span></span><br><span class="line"><span class="comment">// element is clicked on, it turns blue</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; elements.length; i++) &#123;</span><br><span class="line">  elements[i].addEventListener(<span class="string">'click'</span>, bluify, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>this</code> in <u><strong>inline event handler</strong></u></p>
<ul>
<li><p><code>this</code> is set to the DOM element <strong><u>where the listener is placed</u></strong></p>
</li>
<li><p>however, only the outer code has its <code>this</code> set this way</p>
</li>
<li><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1. this will refer to 'button' --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"alert(this.tagName.toLowerCase());"</span>&gt;</span></span><br><span class="line">  Show this</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 2. 'this' will refer to 'window' --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"alert((function() &#123; return this; &#125;)());"</span>&gt;</span></span><br><span class="line">  Show inner this</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
</li>
</ol>
<h2 id="II-arrow-function"><a href="#II-arrow-function" class="headerlink" title="II. arrow function"></a>II. arrow function</h2><ol>
<li><p>Best suited for <strong><u>non-method</u></strong> functions, ie. not related to method in <em>object</em></p>
</li>
<li><p>No separate <code>this</code> of its own, <em>using others‚Äô</em></p>
<ul>
<li><p>An arrow function does not have its own <code>this</code></p>
</li>
<li><p><code>this</code> value of the enclosing lexical context is used </p>
</li>
<li><p>how to find <code>this</code> of enclosing lexical context:</p>
<ul>
<li><p>check if <code>this</code>  is present in current scope;</p>
</li>
<li><p>check <code>this</code> is present in its enclosing scope;</p>
</li>
<li><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//---------- version1: works -----------------</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.age = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.age++; <span class="comment">// |this| properly refers to the Person object</span></span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person();</span><br><span class="line"></span><br><span class="line"><span class="comment">//---------- version2: doesn't work ----------</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// The Person() constructor defines `this` as an instance of itself.</span></span><br><span class="line">  <span class="keyword">this</span>.age = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  setInterval(<span class="function"><span class="keyword">function</span> <span class="title">growUp</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// In non-strict mode, the growUp() function defines `this` </span></span><br><span class="line">    <span class="comment">// as the global object (because it's where growUp() is executed.), </span></span><br><span class="line">    <span class="comment">// which is different from the `this`</span></span><br><span class="line">    <span class="comment">// defined by the Person() constructor. </span></span><br><span class="line">    <span class="keyword">this</span>.age++;</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person();</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>No binding of <code>arguments</code></p>
<ul>
<li><p>Arrow functions do not have their own <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments" target="_blank" rel="noopener"><code>arguments</code> object</a>.</p>
</li>
<li><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="built_in">arguments</span> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> arr = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">arguments</span>[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">arr(); <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> f = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">arguments</span>[<span class="number">0</span>] + n; <span class="comment">// foo's implicit arguments binding. arguments[0] is n</span></span><br><span class="line">  <span class="keyword">return</span> f();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo(<span class="number">3</span>); <span class="comment">// 6</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>using <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters" target="_blank" rel="noopener">rest parameters</a> is a good alternative to using an <code>arguments</code> object</p>
</li>
<li><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">n</span>) </span>&#123; </span><br><span class="line">  <span class="keyword">var</span> f = <span class="function">(<span class="params">...args</span>) =&gt;</span> args[<span class="number">0</span>] + n; </span><br><span class="line">  <span class="keyword">return</span> f(<span class="number">10</span>); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo(<span class="number">1</span>); <span class="comment">// 11</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><u><strong>When not use arrow function?  ==&gt;  when need <code>this</code> explicitly</strong> </u></p>
<ol>
<li><p>don‚Äôt use as <u>methods of object</u>: </p>
<ul>
<li><p>because we need <code>this</code>, but arrow function doesn‚Äôt have its own <code>this</code></p>
</li>
<li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&apos;use strict&apos;;</span><br><span class="line"></span><br><span class="line">var obj = &#123;</span><br><span class="line">  i: 10,</span><br><span class="line">  b: () =&gt; console.log(this.i, this),</span><br><span class="line">  c: function() &#123;</span><br><span class="line">    console.log(this.i, this);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.b(); // prints undefined, Window &#123;...&#125; (or the global object)</span><br><span class="line">obj.c(); // prints 10, Object &#123;...&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>don‚Äôt use as <u>function constructor</u>:  because we will use <code>new</code> to construct , which need <code>this</code></p>
</li>
<li><p>don‚Äôt add <code>prototype</code> to it:  because it doesn‚Äôt have <code>this</code></p>
</li>
<li><p>don‚Äôt use in <code>yeild</code> or <code>generators</code>: </p>
</li>
</ol>
</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/31/Trie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mingkai Cao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sea.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CMK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/31/Trie/" itemprop="url">Trie</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-08-31T10:07:43-07:00">2018-08-31</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/08/31/Trie/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/08/31/Trie/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="what"><a href="#what" class="headerlink" title="what"></a>what</h2><p>Trie, is actually a more general tree, also <strong>prefix tree</strong>.</p>
<p>Used for <strong><em>massive</em></strong> words process, dictionary representation, and lexicographic sorting, word frequency calc.</p>
<h2 id="How"><a href="#How" class="headerlink" title="How"></a>How</h2><h4 id="I-TrieNode"><a href="#I-TrieNode" class="headerlink" title="I. TrieNode"></a>I. TrieNode</h4><p>TrieNode has mainly two parts:</p>
<ol>
<li><code>children</code>, to link next possible characters appear in a words. If only considering ‚ÄòA-Z‚Äô, there is 26 children at most</li>
<li>info used to record current TrieNode<ul>
<li><code>isWord</code>, denotes previous character is a word or not.</li>
<li><code>cnt</code>, denotes number of words consist of current prefix</li>
</ul>
</li>
</ol>
<p><strong><em>Note:</em></strong> this representation is a little different from binary tree, in which info data are stored for current Node. However, in Trie, info data are stored for previous Node, as follows:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">For dictionary: &#123; <span class="string">"a"</span>, <span class="string">"bd"</span>, <span class="string">"c"</span> &#125;, the Trie would be represented as following:</span><br><span class="line"></span><br><span class="line"><span class="function">root <span class="title">TrieNode</span><span class="params">(<span class="number">0xefe4</span>)</span></span></span><br><span class="line"><span class="function">- cnt: 0</span></span><br><span class="line"><span class="function">- isWord: <span class="keyword">false</span></span></span><br><span class="line"><span class="function">- children:</span>&#123;<span class="string">'a'</span>: TrieNode , <span class="string">'b'</span>: TrieNode, <span class="string">'c'</span>: TrieNode, ... &#125;</span><br><span class="line">            /				      |				          \</span><br><span class="line">            TrieNode(<span class="number">0xffe3</span>)	TrieNode(<span class="number">0xffe4</span>)   			TrieNode(<span class="number">0xffe5</span>)</span><br><span class="line">            - cnt: <span class="number">1</span>			- cnt: <span class="number">0</span>					- cnt: <span class="number">1</span></span><br><span class="line">            - isWord: <span class="keyword">true</span>		- isWord: <span class="keyword">false</span>				- isWord: <span class="keyword">false</span></span><br><span class="line">            - children: <span class="keyword">null</span>	- children: &#123;<span class="string">'d'</span>:TrieNode&#125;  - children: <span class="keyword">null</span></span><br><span class="line">                                    |</span><br><span class="line">                                   ...</span><br></pre></td></tr></table></figure>
<h2 id="Implementation"><a href="#Implementation" class="headerlink" title="Implementation"></a>Implementation</h2><ul>
<li><p>interfaces</p>
<ul>
<li>build (constructor)</li>
<li>isWord</li>
<li>countWord</li>
<li>insert</li>
<li>delete</li>
<li>hasPrefix</li>
<li>getPrefixNode</li>
</ul>
</li>
<li><p>Time Complexity: [ <code>n</code> words, <code>K</code> is number of characters of the longest word ]</p>
<ul>
<li>build: O(nK)</li>
<li>isWord: O(K)</li>
<li>countWord: O(K)</li>
<li>insert: O(K)</li>
<li>delete: O(K)</li>
</ul>
</li>
<li><p>Space Complexity: [<code>N</code> is the number of all characters appears in the dictionary ]</p>
<ul>
<li>too much space: O(N) +O(N^2) +O(N^3) +O(N^4) + O(N^K)</li>
<li>good news is: when it is a really dictionary, all the space will be filled up, so not so much waste</li>
</ul>
</li>
<li><p><code>delete</code> might be a little complex. The to-be-deleted word possibly :</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">when need delete a node, what should really to be done????</span><br><span class="line">    - delete the key from HashMap&lt;Character, Node&gt;</span><br><span class="line">    - reset to <span class="keyword">null</span> when using Node[]</span><br><span class="line">So, always ask two questions:</span><br><span class="line">	- the node to be deleted, is part of other <span class="keyword">long</span> word [by checking <span class="string">'children'</span>]?</span><br><span class="line">    - the node itself is the end of a word? [by checking <span class="string">'isWord'</span> &amp; <span class="string">'cnt'</span>]?</span><br></pre></td></tr></table></figure>
<ul>
<li><code>null</code>, empty string, not exists in the Trie</li>
<li>contains other short words: ‚Äúabc‚Äù, ‚Äúab‚Äù<ul>
<li><strong>recursively from bottom to top</strong> delete node, till the longest prefix</li>
</ul>
</li>
<li>has same words as itself: ‚Äúabc‚Äù, ‚Äúabc‚Äù<ul>
<li>don‚Äôt delete node, only update <code>cnt</code></li>
</ul>
</li>
<li>being a prefix of other long words: ‚Äúabc‚Äù, ‚Äúabcde‚Äù<ul>
<li>don‚Äôt delete node, only update <code>isWord</code></li>
</ul>
</li>
<li>share prefix with other words: ‚Äúabc‚Äù, ‚Äúabd‚Äù<ul>
<li><strong>recursively from bottom to top</strong> delete node, till the longest prefix</li>
</ul>
</li>
<li>only itself in the dictionary, not affect others ‚Äúabc‚Äù<ul>
<li>delte all nodes</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> cnt;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> isWord;</span><br><span class="line">	<span class="keyword">public</span> Map&lt;Character, Node&gt; children;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.cnt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">this</span>.isWord = <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">this</span>.children = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Trie</span></span>&#123;</span><br><span class="line">	Node root;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Trie</span><span class="params">( String[] strArr )</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.root = <span class="keyword">new</span> Node();</span><br><span class="line">		<span class="keyword">for</span>( String str : strArr )&#123;</span><br><span class="line">			insert( str );</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasPrefix</span><span class="params">(String str )</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>( str == <span class="keyword">null</span> || str.length() == <span class="number">0</span> ) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		<span class="keyword">int</span> len = str.length();</span><br><span class="line">		Node cur = <span class="keyword">this</span>.root;</span><br><span class="line">		<span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++ )&#123;</span><br><span class="line">			<span class="keyword">char</span> ch = str.charAt(i);</span><br><span class="line">			<span class="keyword">if</span>( !cur.children.containsKey(ch) ) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">			cur = cur.children.get(ch);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Node <span class="title">getPrefixNode</span> <span class="params">(String str)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>( !hasPrefix(str) ) <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">int</span> len = str.length();</span><br><span class="line">		Node cur = <span class="keyword">this</span>.root;</span><br><span class="line">		<span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++ )&#123;</span><br><span class="line">			<span class="keyword">char</span> ch = str.charAt(i);</span><br><span class="line">			cur = cur.children.get(ch);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> cur;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">( String str )</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>( str == <span class="keyword">null</span> || str.length() == <span class="number">0</span> ) <span class="keyword">return</span>;</span><br><span class="line">		<span class="keyword">int</span> len = str.length();</span><br><span class="line">		Node cur = <span class="keyword">this</span>.root;</span><br><span class="line">		<span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++ )&#123;</span><br><span class="line">			<span class="keyword">char</span> ch = str.charAt(i);</span><br><span class="line">			<span class="keyword">if</span>( !cur.children.containsKey(ch) )&#123;</span><br><span class="line">				cur.children.put( ch, <span class="keyword">new</span> Node() );</span><br><span class="line">			&#125;</span><br><span class="line">			cur = cur.children.get(ch);</span><br><span class="line">		&#125;</span><br><span class="line">		cur.cnt++;</span><br><span class="line">		cur.isWord = <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span> <span class="params">(String str )</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>( str == <span class="keyword">null</span> || str.length() == <span class="number">0</span> ) <span class="keyword">return</span>;</span><br><span class="line">		<span class="keyword">if</span>( !hasPrefix(str) ) <span class="keyword">return</span>;</span><br><span class="line">		Node cur = getPrefixNode(str);</span><br><span class="line">		cur.cnt--; </span><br><span class="line">		<span class="keyword">if</span>(cur.cnt &lt; <span class="number">0</span>) cur.cnt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(cur.cnt &gt; <span class="number">0</span>) <span class="keyword">return</span>; 	<span class="comment">// at this position, there still word exist</span></span><br><span class="line">		<span class="keyword">else</span>&#123;						<span class="comment">// at this position, there no word exist</span></span><br><span class="line">			<span class="keyword">if</span>( cur.children.size() &gt; <span class="number">0</span> ) &#123;	<span class="comment">// but can be prefix of other words</span></span><br><span class="line">				cur.isWord = <span class="keyword">false</span>;</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;							<span class="comment">// not a word, nor a prefix of others</span></span><br><span class="line">				deleteNode(str);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteNode</span><span class="params">( String str )</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> len = str.length();</span><br><span class="line">		<span class="keyword">if</span>( len == <span class="number">0</span> ) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">		String prevStr = str.substring(<span class="number">0</span>, len-<span class="number">1</span>);</span><br><span class="line">		Node prevNode = getPrefixNode(prevStr);</span><br><span class="line">		prevNode.children.remove(str.charAt(len-<span class="number">1</span>));</span><br><span class="line">		<span class="keyword">if</span>( prevNode.children.size()==<span class="number">0</span> &amp;&amp; prevNode.cnt==<span class="number">0</span> ) delete(prevStr);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isWord</span><span class="params">( String str )</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>( !hasPrefix(str) ) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">return</span> getPrefixNode(str).isWord;</span><br><span class="line">	&#125;	</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countWord</span><span class="params">( String str )</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>( !hasPrefix(str) ) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span> getPrefixNode(str).cnt;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrieTree</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String[] args )</span></span>&#123;</span><br><span class="line">		String[] dict = &#123; <span class="string">"a"</span>, <span class="string">"ab"</span>, <span class="string">"ab"</span>, <span class="string">"abc"</span>, <span class="string">"abc"</span>, <span class="string">"abc"</span>, <span class="string">"abcd"</span>, <span class="string">"ac"</span>, <span class="string">"acd"</span>, <span class="string">"ad"</span>, <span class="string">"2,24"</span>,  <span class="string">"2,2,4"</span> &#125;;</span><br><span class="line">		Trie trieTree = <span class="keyword">new</span> Trie(dict);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// String isWordTest1 = "ab";</span></span><br><span class="line">		<span class="comment">// String isWordTest2 = "";</span></span><br><span class="line">		<span class="comment">// String isWordTest3 = "a";</span></span><br><span class="line">		<span class="comment">// String isWordTest4 = "abcd";</span></span><br><span class="line">		<span class="comment">// String isWordTest5 = "abcde";</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// String countTest = "abc";</span></span><br><span class="line">		<span class="comment">// String insertTest = "abc";</span></span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		<span class="comment">// System.out.println( trieTree.isWord(isWordTest1));</span></span><br><span class="line">		<span class="comment">// System.out.println( trieTree.isWord(isWordTest2));</span></span><br><span class="line">		<span class="comment">// System.out.println( trieTree.isWord(isWordTest3));</span></span><br><span class="line">		<span class="comment">// System.out.println( trieTree.isWord(isWordTest4));</span></span><br><span class="line">		<span class="comment">// System.out.println( trieTree.isWord(isWordTest5));</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="comment">// System.out.println( trieTree.countWord(countTest));</span></span><br><span class="line">		<span class="comment">// trieTree.insert(insertTest);</span></span><br><span class="line">		<span class="comment">// System.out.println( trieTree.countWord(countTest));</span></span><br><span class="line">		<span class="comment">// trieTree.insert(insertTest);</span></span><br><span class="line">		<span class="comment">// System.out.println( trieTree.countWord(countTest));</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="comment">// String hasPrefixTest1 = "abcd";</span></span><br><span class="line">		<span class="comment">// String hasPrefixTest2 = "2,2";</span></span><br><span class="line">		<span class="comment">// String hasPrefixTest3 = "abcdd";</span></span><br><span class="line">		<span class="comment">// System.out.println( trieTree.hasPrefix(hasPrefixTest1));</span></span><br><span class="line">		<span class="comment">// System.out.println( trieTree.hasPrefix(hasPrefixTest2));</span></span><br><span class="line">		<span class="comment">// System.out.println( trieTree.hasPrefix(hasPrefixTest3));</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		String deleteTest1 = <span class="string">"abcd"</span>;</span><br><span class="line">		String deleteTest2 = <span class="string">"abc"</span>;</span><br><span class="line">		String deleteTest3 = <span class="string">"ab"</span>;</span><br><span class="line">		trieTree.delete(deleteTest1);</span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest3)); <span class="comment">// 2</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest2)); <span class="comment">// 3</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest1)); <span class="comment">// 0</span></span><br><span class="line">		System.out.println();</span><br><span class="line"></span><br><span class="line">		trieTree.delete(deleteTest1);</span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest3)); <span class="comment">// 2</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest2)); <span class="comment">// 3</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest1)); <span class="comment">// 0</span></span><br><span class="line">		System.out.println();</span><br><span class="line"></span><br><span class="line">		trieTree.delete(deleteTest2);</span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest3)); <span class="comment">// 2</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest2)); <span class="comment">// 2</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest1)); <span class="comment">// 0</span></span><br><span class="line">		System.out.println();</span><br><span class="line">		</span><br><span class="line">		trieTree.delete(deleteTest2);</span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest3)); <span class="comment">// 2</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest2)); <span class="comment">// 1</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest1)); <span class="comment">// 0</span></span><br><span class="line">		System.out.println();</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		trieTree.delete(deleteTest2);</span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest3)); <span class="comment">// 2</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest2)); <span class="comment">// 0</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest1)); <span class="comment">// 0</span></span><br><span class="line">		System.out.println();</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		trieTree.delete(deleteTest2);</span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest3)); <span class="comment">// 2</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest2)); <span class="comment">// 0</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest1)); <span class="comment">// 0</span></span><br><span class="line">		System.out.println();</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		trieTree.delete(deleteTest3);</span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest3)); <span class="comment">// 1</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest2)); <span class="comment">// 0</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest1)); <span class="comment">// 0</span></span><br><span class="line">		System.out.println();</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		trieTree.delete(deleteTest3);</span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest3)); <span class="comment">// 0</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest2)); <span class="comment">// 0</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest1)); <span class="comment">// 0</span></span><br><span class="line">		System.out.println();</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		trieTree.delete(deleteTest1);</span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest3)); <span class="comment">// 0</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest2)); <span class="comment">// 0</span></span><br><span class="line">		System.out.println( trieTree.countWord(deleteTest1)); <span class="comment">// 0</span></span><br><span class="line">		System.out.println();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/23/Specifio-Work-Summary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mingkai Cao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sea.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CMK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/23/Specifio-Work-Summary/" itemprop="url">Specifio Work Summary</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-08-23T20:04:05-07:00">2018-08-23</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Portfolios/" itemprop="url" rel="index"><span itemprop="name">Portfolios</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/08/23/Specifio-Work-Summary/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/08/23/Specifio-Work-Summary/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="I-PHP-legacy-website-to-React"><a href="#I-PHP-legacy-website-to-React" class="headerlink" title="I. PHP legacy website to React"></a>I. PHP legacy website to React</h2><h4 id="1-Current-website-PHP"><a href="#1-Current-website-PHP" class="headerlink" title="1. Current website (PHP)"></a>1. Current website (PHP)</h4><p>The company website in use is the old one at <a href="https://specif.io/" target="_blank" rel="noopener">https://specif.io/</a>.<br>Hopefully, Our new website will be put into use by October, 2018.</p>
<h4 id="2-New-website-React-Gatsby-Sass"><a href="#2-New-website-React-Gatsby-Sass" class="headerlink" title="2. New website (React, Gatsby, Sass)"></a>2. New website (React, Gatsby, Sass)</h4><p>The new website is currently on staging, but you can still visit it through this link: <a href="https://publicdocker.specif.io/" target="_blank" rel="noopener">https://publicdocker.specif.io/</a></p>
<p><strong>New features:</strong></p>
<ul>
<li>Static webpage auto generating from Markdown file <strong>(Gatsby.js)</strong></li>
<li>better layout &amp; color scheme <strong>(React)</strong></li>
<li>more user friendly</li>
<li>more intuitive</li>
<li>convey more information</li>
</ul>
<h2 id="II-Admin-Panel"><a href="#II-Admin-Panel" class="headerlink" title="II. Admin Panel"></a>II. Admin Panel</h2><p>Developped Admin Panel for both internal and external use, with 3-level privileged access.</p>
<p><img src="https://github.com/caomingkai/specifio_projects/raw/master/Admin%20Panel/docPlan.png" alt="Admin Panel"></p>
<h4 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction:"></a>1. Introduction:</h4><ol>
<li><p>With Specifio‚Äôs Doc Plans feature, practitioners can control how Specifio creates draft applications so they consistently meet the preferences and requirements of clients and reviewers.</p>
</li>
<li><p>A practitioner‚Äôs ‚Äúactive‚Äù Doc Plan controls the appearance, content, and structure of the auto-drafts created by Specifio.</p>
</li>
<li><p>Practitioners can design a collection of different Doc Plans for different clients, technologies, or reviewers.</p>
</li>
<li><p>Doc Plans can be shared among registered users within your firm.</p>
</li>
</ol>
<h4 id="2-Snapshots-for-key-features"><a href="#2-Snapshots-for-key-features" class="headerlink" title="2. Snapshots for key features"></a>2. Snapshots for key features</h4><ul>
<li><p><strong>Video: Live demo page for setting like layout, format and content of their Doc Plans</strong></p>
<p>  <a href="http://www.youtube.com/watch?feature=player_embedded&v=Gl8TfGINxko" target="_blank"><img src="http://img.youtube.com/vi/Gl8TfGINxko/0.jpg" alt="Doc Editor" width="400" height="300" border="8"></a></p>
</li>
<li><p><strong>Dashboard</strong></p>
<p>  <img width="400" alt="auth0" src="https://github.com/caomingkai/specifio_projects/raw/master/Admin%20Panel/dashboard1.png"><br>  <br><br>  <img width="400" alt="auth0" src="https://github.com/caomingkai/specifio_projects/raw/master/Admin%20Panel/dashboard2.png"></p>
</li>
<li><p><strong>Auth0 integration</strong></p>
<p>  <img width="400" alt="auth0" src="https://github.com/caomingkai/specifio_projects/raw/master/Admin%20Panel/auth0.png"></p>
</li>
<li><p><strong>Manage doc plans</strong></p>
<p>  <img width="400" alt="docPlan.png" src="https://github.com/caomingkai/specifio_projects/raw/master/Admin%20Panel/docPlan.png"></p>
</li>
<li><p><strong>Manage profile</strong></p>
<p>   <img width="400" alt="profile.png" src="https://github.com/caomingkai/specifio_projects/raw/master/Admin%20Panel/profile.png"></p>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/01/Node-js/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mingkai Cao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sea.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CMK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/01/Node-js/" itemprop="url">Node.js</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-01T16:24:07-07:00">2018-06-01</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Full-stack/" itemprop="url" rel="index"><span itemprop="name">Full stack</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/06/01/Node-js/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/06/01/Node-js/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="I-Event-driven-amp-asynchrous-I-O"><a href="#I-Event-driven-amp-asynchrous-I-O" class="headerlink" title="I. Event-driven &amp; asynchrous I/O"></a>I. Event-driven &amp; asynchrous I/O</h2><p>Common code snippet we always find:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">"http"</span>);</span><br><span class="line"></span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">  response.writeHead(<span class="number">200</span>, &#123;<span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span>&#125;);</span><br><span class="line">  response.write(<span class="string">"Hello World"</span>);</span><br><span class="line">  response.end();</span><br><span class="line">&#125;).listen(<span class="number">8888</span>);</span><br></pre></td></tr></table></figure>
<p>The code above in fact has same effect as following. The difference is:</p>
<ul>
<li>Callback function in code above is anonomous function</li>
<li>Callback function in code below has a name: <code>onRequest</code></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">"http"</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onRequest</span>(<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">  response.writeHead(<span class="number">200</span>, &#123;<span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span>&#125;);</span><br><span class="line">  response.write(<span class="string">"Hello World"</span>);</span><br><span class="line">  response.end();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http.createServer(onRequest).listen(<span class="number">8888</span>);</span><br></pre></td></tr></table></figure>
<p>From the second code snippet, we know several importance thing:</p>
<ul>
<li><strong>It creates a server on port:8888</strong></li>
<li><strong>After creation, it won‚Äôt wait there (‚Äòit‚Äô means ‚Äòthread‚Äô)</strong></li>
<li><strong>Instead, it register a callback function; and leave for other tasks</strong></li>
</ul>
<p>Now, magic things could happen:</p>
<ul>
<li><strong>The thread could handle other tasks, like reading data from database</strong></li>
<li><strong>When a request comes, the thread will be recalled to execute the callback function</strong></li>
<li><strong>This way, a single thread can work to its full postential without unnecessary waiting</strong></li>
</ul>
<h2 id="II-Global-variables"><a href="#II-Global-variables" class="headerlink" title="II. Global variables"></a>II. Global variables</h2><ol>
<li><code>console</code> =&gt; <code>console.log(&#39;11&#39;)</code></li>
<li><code>process</code> =&gt; <code>process.exit(0)</code></li>
</ol>
<h2 id="III-Versions"><a href="#III-Versions" class="headerlink" title="III. Versions"></a>III. Versions</h2><ol>
<li><strong>semantic versioning</strong> <ul>
<li>consists of three numbers, separated by periods, such as 2.3.0</li>
<li>the middle number has to be incremented, when new functionality is added</li>
<li>the first number has to be incremented, when compatibility is broken, so that existing code that uses the package might not work with the new version,</li>
</ul>
</li>
<li><strong>caret character (^)</strong><ul>
<li>any version compatible with the given number may be installed</li>
<li><code>^2.3.0</code> would mean that any version greater than or equal to 2.3.0 and less than 3.0.0 is allowed</li>
</ul>
</li>
</ol>
<h2 id="IV-File-System"><a href="#IV-File-System" class="headerlink" title="IV. File System"></a>IV. File System</h2>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/01/Express-Framework/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mingkai Cao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sea.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CMK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/01/Express-Framework/" itemprop="url">Express Framework</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-01T14:44:43-07:00">2018-06-01</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Full-stack/" itemprop="url" rel="index"><span itemprop="name">Full stack</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/06/01/Express-Framework/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/06/01/Express-Framework/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="I-set"><a href="#I-set" class="headerlink" title="I. set()"></a>I. <code>set()</code></h2><blockquote>
<p>You can use the express instance to store and retrieve variables. In this case, you can set the title to be ‚ÄúMy Site‚Äù and retrieve it later with something like <code>var title = app.get(&#39;title&#39;);</code><strong>without the need to declare and keep a global variable messing around</strong></p>
</blockquote>
<p>Âç≥Áõ∏ÂΩì‰∫éÂú® ExpressÁöÑscope‰∏≠ËÆæÁΩÆÂÖ®Â±ÄÂèòÈáè</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.set(<span class="string">'title'</span>,<span class="string">'My Website'</span>);  <span class="comment">// set()</span></span><br><span class="line"><span class="keyword">var</span> title = app.get(<span class="string">'title'</span>);   <span class="comment">// get()</span></span><br><span class="line"></span><br><span class="line">Á≠â‰ª∑‰∫é</span><br><span class="line"></span><br><span class="line">title = <span class="string">'My Website'</span></span><br></pre></td></tr></table></figure>
<h2 id="II-bodyParser"><a href="#II-bodyParser" class="headerlink" title="II. bodyParser"></a>II. <code>bodyParser</code></h2><ol>
<li><p>Áî®Êù•ËØÜÂà´ÂÉè<code>form</code>ÁöÑ<code>submit</code>ÈªòËÆ§Êèê‰∫§ÁöÑ<code>urlencoded</code>Ê†ºÂºèÊï∞ÊçÆÔºåÂπ∂Â∞ÜÂÖ∂ÊîæÂú®<code>res.body</code>‰∏≠</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br></pre></td></tr></table></figure>
</li>
<li><p>Áî®Êù•ËØÜÂà´‰ΩøÁî®<code>fetch()</code>Êàñ<code>axios</code>Êèê‰∫§ÁöÑÁöÑ<code>json</code>Ê†ºÂºèÊï∞ÊçÆÔºåÂπ∂Â∞ÜÂÖ∂ÊîæÂú®<code>res.body</code>‰∏≠</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.use(bodyParser.json());</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="III-to-be-continued"><a href="#III-to-be-continued" class="headerlink" title="III. to be continued"></a>III. to be continued</h2>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/29/MERN-Stack-Online-Exam-System/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mingkai Cao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sea.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CMK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/29/MERN-Stack-Online-Exam-System/" itemprop="url">MERN Stack: Online Exam System</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-29T15:38:28-07:00">2018-05-29</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Portfolios/" itemprop="url" rel="index"><span itemprop="name">Portfolios</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/05/29/MERN-Stack-Online-Exam-System/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/05/29/MERN-Stack-Online-Exam-System/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="I-About"><a href="#I-About" class="headerlink" title="I. About"></a>I. About</h2><ul>
<li>A <strong>MERN stack</strong> online examination application, providing features like <ul>
<li><em>JWT authentication</em></li>
<li><em>random questions generation</em>,</li>
<li><em>timer</em> </li>
<li><em>automatic grading</em></li>
</ul>
</li>
</ul>
<h2 id="II-Github"><a href="#II-Github" class="headerlink" title="II.  Github"></a>II.  Github</h2><p><a href="https://github.com/caomingkai/Online-Exam-System.git" target="_blank" rel="noopener">https://github.com/caomingkai/Online-Exam-System.git</a></p>
<ul>
<li>MongoDB, Mongoose</li>
<li>Node.js, Express</li>
<li>ReactJS, Redux, React Router</li>
<li>JWT, Passport</li>
</ul>
<h2 id="III-How-to-run-it"><a href="#III-How-to-run-it" class="headerlink" title="III. How to run it?"></a>III. How to run it?</h2><ol>
<li><code>git clone</code> it</li>
</ol>
<ul>
<li><code>cd</code> into frontend folder and backend folder, and run <code>npm install</code> respectively</li>
<li>run <code>npm start</code> from frontend folder</li>
<li>run <code>nodemon app.js</code>from backend folder</li>
</ul>
<h2 id="IV-Charts"><a href="#IV-Charts" class="headerlink" title="IV. Charts"></a>IV. Charts</h2><ul>
<li><p><strong>Chart1: Login Page</strong></p>
  <img src="/2018/05/29/MERN-Stack-Online-Exam-System/NAFlogin.png">
</li>
<li><p><strong>Chart2: Main Page ( todo: css )</strong></p>
  <img src="/2018/05/29/MERN-Stack-Online-Exam-System/NAF.png">
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/21/Authetication-JWT-vs-Session/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mingkai Cao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sea.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CMK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/21/Authetication-JWT-vs-Session/" itemprop="url">Authetication: JWT vs Session</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-21T21:59:55-07:00">2018-05-21</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Full-stack/" itemprop="url" rel="index"><span itemprop="name">Full stack</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/05/21/Authetication-JWT-vs-Session/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/05/21/Authetication-JWT-vs-Session/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="I-Why-do-we-need-Authetication"><a href="#I-Why-do-we-need-Authetication" class="headerlink" title="I. Why do we need Authetication?"></a>I. Why do we need Authetication?</h2><p><strong>Scenario: bank accout transaction</strong></p>
<blockquote>
<p>Authetication: an approach to know ‚ÄúAlice‚Äù from client side is the real ‚ÄúAlice‚Äù in the bank database</p>
</blockquote>
<p>The bank web server needs a way to identify its customers‚Äô true identity, knowing ‚ÄòAlice‚Äô is the real ‚ÄòAlice‚Äô as she claims.</p>
<h2 id="II-session-amp-cookie-authetication"><a href="#II-session-amp-cookie-authetication" class="headerlink" title="II. session&amp;cookie authetication"></a>II. <code>session&amp;cookie</code> authetication</h2><p><strong>1. Solution A</strong>   </p>
<p>An approach is checking her account&amp;password. If matches, she can access Alice‚Äôs bank account; Otherwise, no way to Alice‚Äôs bank account.</p>
<p><strong>2. Problem of Solution A</strong> </p>
<p>HTTP is stateless. After Alice log into the server, next time when Alice make another request to draw ¬•100 from her account (<em>subtract ¬•100 from her accout</em>). Now she still needs to prove she is Alice. But asking her accout&amp;password again and again is rediculous!</p>
<p><strong>3. Solution B:<code>session</code> &amp; <code>cookie</code></strong> </p>
<ul>
<li>First time, the Alice log into her account on bank server; </li>
<li>Bank server maintains a session for her, and issues <code>sessionID</code> to her <code>cookie</code>. </li>
<li>Later, each time Alice want to make a transaction, she makes HTTP requests with that <code>sessionID</code>(all HTTP requests carry <code>cookie</code> )</li>
<li>Until a certain period of time, the <code>session</code> for Alice become invalid if no activities from Alice</li>
<li>After a inactive period, if Alice wants to make transaction again, she has to log into system to set up a new <code>session</code> in bank server</li>
<li><code>Server</code>is the safe guard**, preventing evil from accessing sensitive bank account information. Using <code>session</code>and<code>cookie</code>, customers finally don‚Äôt have to input their account&amp;password again and again!</li>
</ul>
<p><strong>4. New problem in ‚Äúdistributed‚Äù serivce system</strong>   </p>
<ul>
<li><p><strong><code>Distributed</code></strong> means: after Alice log into her account on server#1, next time she might be directed by <code>load balancer</code> to server#2, if at that time server#1 is already serving extremely large amount of people.</p>
</li>
<li><p><strong>New problem is:</strong> <code>session &amp; cookie</code> approach doesn‚Äôt work in this case. Server#1 has Alice‚Äôs necessary<code>context</code> for following transaction after she logs into it. But server#2 doesn‚Äôt even know who she is! So, Alice is asked for her account and password again! Bad user experience!!!</p>
</li>
</ul>
<p><strong>5. Soutions for ‚Äúdistributed‚Äù serivce system</strong>   </p>
<blockquote>
<p>„ÄêÂ•ΩÊñá„Äë<a href="https://www.cnblogs.com/study-everyday/p/7853145.html" target="_blank" rel="noopener">https://www.cnblogs.com/study-everyday/p/7853145.html</a></p>
</blockquote>
<ul>
<li><strong>version 1: session dupication (Â§öÊú∫ÂêåÊ≠•)</strong><ul>
<li>ÊÄùË∑ØÔºöÂ§ö‰∏™web-server‰πãÈó¥Áõ∏‰∫íÂêåÊ≠•sessionÔºåËøôÊ†∑ÊØè‰∏™web-server‰πãÈó¥ÈÉΩÂåÖÂê´ÂÖ®ÈÉ®ÁöÑsession</li>
<li>‰ºòÁÇπÔºöweb-serverÊîØÊåÅÁöÑÂäüËÉΩÔºåÂ∫îÁî®Á®ãÂ∫è‰∏çÈúÄË¶Å‰øÆÊîπ‰ª£Á†Å</li>
<li>‰∏çË∂≥Ôºö<ul>
<li>sessionÁöÑÂêåÊ≠•ÈúÄË¶ÅÊï∞ÊçÆ‰º†ËæìÔºåÂç†ÂÜÖÁΩëÂ∏¶ÂÆΩÔºåÊúâÊó∂Âª∂</li>
<li>ÊâÄÊúâweb-serverÈÉΩÂåÖÂê´ÊâÄÊúâsessionÊï∞ÊçÆÔºåÊï∞ÊçÆÈáèÂèóÂÜÖÂ≠òÈôêÂà∂ÔºåÊó†Ê≥ïÊ∞¥Âπ≥Êâ©Â±ï</li>
<li>ÊúâÊõ¥Â§öweb-serverÊó∂Ë¶ÅÊ≠áËèú</li>
</ul>
</li>
</ul>
</li>
<li><strong>version 2: Session Storage at brower (ÂÆ¢Êà∑Á´ØÂ≠òÂÇ®Ê≥ï)</strong><ul>
<li>ÊÄùË∑ØÔºöÊúçÂä°Á´ØÂ≠òÂÇ®ÊâÄÊúâÁî®Êà∑ÁöÑsessionÔºåÂÜÖÂ≠òÂç†Áî®ËæÉÂ§ßÔºåÂèØ‰ª•Â∞ÜsessionÂ≠òÂÇ®Âà∞ÊµèËßàÂô®cookie‰∏≠ÔºåÊØè‰∏™Á´ØÂè™Ë¶ÅÂ≠òÂÇ®‰∏Ä‰∏™Áî®Êà∑ÁöÑÊï∞ÊçÆ‰∫Ü</li>
<li>‰ºòÁÇπÔºöÊúçÂä°Á´Ø‰∏çÈúÄË¶ÅÂ≠òÂÇ®</li>
<li>Áº∫ÁÇπÔºö<ul>
<li>ÊØèÊ¨°httpËØ∑Ê±ÇÈÉΩÊê∫Â∏¶sessionÔºåÂç†Â§ñÁΩëÂ∏¶ÂÆΩ</li>
<li>Êï∞ÊçÆÂ≠òÂÇ®Âú®Á´Ø‰∏äÔºåÂπ∂Âú®ÁΩëÁªú‰º†ËæìÔºåÂ≠òÂú®Ê≥ÑÊºè„ÄÅÁØ°Êîπ„ÄÅÁ™ÉÂèñÁ≠âÂÆâÂÖ®ÈöêÊÇ£</li>
<li>sessionÂ≠òÂÇ®ÁöÑÊï∞ÊçÆÂ§ßÂ∞èÂèócookieÈôêÂà∂</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>version 3: Nginx reverse proxy hash: (ÂèçÂêë‰ª£ÁêÜhash‰∏ÄËá¥ÊÄß)</strong></p>
<ul>
<li>ÊÄùË∑ØÔºöÂèçÂêë‰ª£ÁêÜÂ±Ç‰ΩøÁî®Áî®Êà∑ipÊù•ÂÅöhashÔºå‰ª•‰øùËØÅÂêå‰∏Ä‰∏™ipÁöÑËØ∑Ê±ÇËêΩÂú®Âêå‰∏Ä‰∏™web-server‰∏ä</li>
<li><p>‰ºòÁÇπÔºö</p>
<ul>
<li>Âè™ÈúÄË¶ÅÊîπnginxÈÖçÁΩÆÔºå‰∏çÈúÄË¶Å‰øÆÊîπÂ∫îÁî®‰ª£Á†Å</li>
<li>Ë¥üËΩΩÂùáË°°ÔºåÂè™Ë¶ÅhashÂ±ûÊÄßÊòØÂùáÂåÄÁöÑÔºåÂ§öÂè∞web-serverÁöÑË¥üËΩΩÊòØÂùáË°°ÁöÑ</li>
<li>ÂèØ‰ª•ÊîØÊåÅweb-serverÊ∞¥Âπ≥Êâ©Â±ïÔºàsessionÂêåÊ≠•Ê≥ïÊòØ‰∏çË°åÁöÑÔºåÂèóÂÜÖÂ≠òÈôêÂà∂Ôºâ</li>
</ul>
</li>
<li><p>‰∏çË∂≥Ôºö</p>
<ul>
<li>Â¶ÇÊûúweb-serverÈáçÂêØÔºå‰∏ÄÈÉ®ÂàÜsession‰ºö‰∏¢Â§±Ôºå‰∫ßÁîü‰∏öÂä°ÂΩ±ÂìçÔºå‰æãÂ¶ÇÈÉ®ÂàÜÁî®Êà∑ÈáçÊñ∞ÁôªÂΩï</li>
<li>Â¶ÇÊûúweb-serverÊ∞¥Âπ≥Êâ©Â±ïÔºårehashÂêésessionÈáçÊñ∞ÂàÜÂ∏ÉÔºå‰πü‰ºöÊúâ‰∏ÄÈÉ®ÂàÜÁî®Êà∑Ë∑ØÁî±‰∏çÂà∞Ê≠£Á°ÆÁöÑsession</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>version 4: Database layer for whole session(ÂêéÁ´ØÁªü‰∏ÄÈõÜ‰∏≠Â≠òÂÇ®)</strong></p>
<ul>
<li>ÊÄùË∑ØÔºöÂ∞ÜsessionÂ≠òÂÇ®Âú®web-serverÂêéÁ´ØÁöÑÂ≠òÂÇ®Â±ÇÔºåÊï∞ÊçÆÂ∫ìÊàñËÄÖÁºìÂ≠ò</li>
<li><p>‰ºòÁÇπÔºö</p>
<ul>
<li>Ê≤°ÊúâÂÆâÂÖ®ÈöêÊÇ£</li>
<li>ÂèØ‰ª•Ê∞¥Âπ≥Êâ©Â±ïÔºåÊï∞ÊçÆÂ∫ì/ÁºìÂ≠òÊ∞¥Âπ≥ÂàáÂàÜÂç≥ÂèØ</li>
<li>web-serverÈáçÂêØÊàñËÄÖÊâ©ÂÆπÈÉΩ‰∏ç‰ºöÊúâsession‰∏¢Â§±</li>
</ul>
</li>
<li><p>‰∏çË∂≥Ôºö</p>
<ul>
<li>Â¢ûÂä†‰∫Ü‰∏ÄÊ¨°ÁΩëÁªúË∞ÉÁî®ÔºåÂπ∂‰∏îÈúÄË¶Å‰øÆÊîπÂ∫îÁî®‰ª£Á†Å</li>
</ul>
<p>sessionËØªÂèñÁöÑÈ¢ëÁéá‰ºöÂæàÈ´òÔºåÊï∞ÊçÆÂ∫ìÂéãÂäõ‰ºöÊØîËæÉÂ§ß„ÄÇÂ¶ÇÊûúÊúâsessionÈ´òÂèØÁî®ÈúÄÊ±ÇÔºåcacheÂèØ‰ª•ÂÅöÈ´òÂèØÁî®Ôºå‰ΩÜÂ§ßÈÉ®ÂàÜÊÉÖÂÜµ‰∏ãsessionÂèØ‰ª•‰∏¢Â§±Ôºå‰∏ÄËà¨‰πü‰∏çÈúÄË¶ÅËÄÉËôëÈ´òÂèØÁî®„ÄÇ</p>
</li>
</ul>
</li>
<li><p><strong>Summary: for improved <code>session&amp;cookie</code> approach</strong></p>
<p>  ÂØπ‰∫éÊñπÊ°à3ÂíåÊñπÊ°à4ÔºåÊé®ËçêÂêéËÄÖÔºö</p>
<ul>
<li>webÂ±Ç„ÄÅserviceÂ±ÇÊó†Áä∂ÊÄÅÊòØÂ§ßËßÑÊ®°ÂàÜÂ∏ÉÂºèÁ≥ªÁªüËÆæËÆ°ÂéüÂàô‰πã‰∏ÄÔºåsessionÂ±û‰∫éÁä∂ÊÄÅÔºå‰∏çÂÆúÊîæÂú®webÂ±Ç</li>
<li>ËÆ©‰∏ì‰∏öÁöÑËΩØ‰ª∂ÂÅö‰∏ì‰∏öÁöÑ‰∫ãÊÉÖÔºåweb-serverÂ≠òsessionÔºüËøòÊòØËÆ©cacheÂéªÂÅöËøôÊ†∑ÁöÑ‰∫ãÊÉÖÂêß„ÄÇ</li>
</ul>
</li>
</ul>
<h2 id="III-JWT-authetication"><a href="#III-JWT-authetication" class="headerlink" title="III. JWT authetication"></a>III. JWT authetication</h2><blockquote>
<p>Â•ΩÊñá: <a href="https://www.ctolib.com/flylib-fly-auth.html" target="_blank" rel="noopener">https://www.ctolib.com/flylib-fly-auth.html</a></p>
</blockquote>
<blockquote>
<ol>
<li>server‰∏çÂÜç‰Ωú‰∏∫<code>ÊïèÊÑüÊï∞ÊçÆÂ∫ì</code>ÁöÑÂÖ≥Âç°Ôºå‰∏∫clientÊúçÂä°Ôºõ</li>
<li>browerËá™Â∑±<code>ÊØèÊ¨°</code>ÈÉΩÊê∫Â∏¶<code>authentication token</code>ËøõË°årequest</li>
</ol>
</blockquote>
<p><strong>0.„ÄêJWTÊú¨Ë¥®Ôºö„Äë</strong> </p>
<ul>
<li><strong>Áõ∏ÂΩì‰∫éÊØèÊ¨°browser requestÔºåÈÉΩË¶ÅÊ±ÇÁî®Êà∑ËæìÂÖ•<code>account &amp; password</code></strong>   </li>
<li><strong>Âç≥ÔºöÁ¨¨‰∏ÄÊ¨°Áî®Êà∑ÁôªÈôÜÊàêÂäüÂêéÔºåserverÊ†πÊçÆÂÖ∂‚ÄúÁî®Êà∑ÂêçÂØÜÁ†Å‚ÄùÁîüÊàêÂîØ‰∏Ä‚Äú‰ª§Áâåtoken‚ÄùÔºåÂæÄÂêéËØ•Áî®Êà∑Âè™Ë¶ÅÂ∏¶‰∏äËØ•tokenËøõË°åËÆøÈóÆÂ∞±ÂèØ‰ª•</strong>   </li>
<li><strong>Áõ∏ÂêåÁÇπÔºö<code>session</code>ÊñπÊ≥ïÁ±ª‰ººÔºå<code>cookie</code>‰∏≠ÁöÑ<code>sessionID</code>‰πüÁõ∏ÂΩì‰∫é‚Äú‰ª§Áâåtoken‚ÄùÔºåÊØèÊ¨°ËØ∑Ê±ÇÈÉΩÊê∫Â∏¶‰∏ä</strong></li>
<li><strong>‰∏çÂêåÁÇπÔºö</strong><ul>
<li><strong><code>JWT</code>ÊñπÊ≥ïÁöÑtokenÁîüÊàê‰æùËµñ‰∫é<code>Áî®Êà∑ÂêçÂØÜÁ†Å</code>‰∏é<code>SHA256</code>Ôºå‰∏çÂèóserverÁéØÂ¢ÉÂΩ±Âìç</strong></li>
<li><strong><code>session</code>ÊñπÊ≥ïÁöÑ<code>sessionID</code>ÁîüÊàê‰æùËµñ‰∫é<code>server session context</code>ÔºåÊØè‰∏™serverÁîüÊàêÁöÑ<code>sessionID</code>‰∏ç‰∏ÄËá¥ÔºåÊó†Ê≥ïÈÄÇÁî®‰∫édistributed system</strong></li>
</ul>
</li>
</ul>
<p><strong>1. Problems with <code>session</code> approach</strong> </p>
<ul>
<li>memcacheÊàñËÄÖredisÁöÑ<strong>Á®≥ÂÆöÊÄß</strong>‰ºöÂΩ±Âìç‰∏öÂä°Á≥ªÁªüÁöÑÂèØÁî®ÊÄß</li>
<li><strong>ÂæÆÊúçÂä°ÁöÑÂπ∂ÂèëËÉΩÂäõ</strong>ÂèóÈôê‰∫émemcacheÊàñËÄÖredisÁöÑÂπ∂ÂèëËÉΩÂäõ</li>
<li>Áî±Ê≠§ÂèØËßÅÔºåÈõÜ‰∏≠ÁöÑsessionÁÆ°ÁêÜ‰πü‰∏çÊòØÊúÄ‰ºòÁöÑÈÄâÊã©„ÄÇ</li>
<li>Êàë‰ª¨‰∏çÂÜçÂÖ≥Ê≥®sessionÊú¨ ÔºåÊääsessionÁöÑÈóÆÈ¢òÊäõÂºÄÔºåËÆ©Êàë‰ª¨ÁöÑÊúçÂä°ÈÉΩÊòØÊó†Áä∂ÊÄÅÁöÑ„ÄÇ</li>
<li>‰∫éÊòØÊàë‰ª¨ÊääÁõÆÂÖâËΩ¨ÂêëWEB TOKEN: JWTÔºàJson web token Ôºâ    </li>
</ul>
<p><strong>2. Benefits using JWT</strong></p>
<blockquote>
<p>„ÄêÂ•ΩÊñá„Äë<a href="https://www.ctolib.com/topics-113075.html" target="_blank" rel="noopener">https://www.ctolib.com/topics-113075.html</a></p>
</blockquote>
<ul>
<li>Ëß£ÂÜ≥Ë∑®ÂüüÈóÆÈ¢òÔºöËøôÁßçÂü∫‰∫éTokenÁöÑËÆøÈóÆÁ≠ñÁï•ÂèØ‰ª•ÂÖãÊúçcookiesÁöÑË∑®ÂüüÈóÆÈ¢ò„ÄÇ</li>
<li>ÊúçÂä°Á´ØÊó†Áä∂ÊÄÅÂèØ‰ª•Ê®™ÂêëÊâ©Â±ïÔºåTokenÂèØÂÆåÊàêËÆ§ËØÅÔºåÊó†ÈúÄÂ≠òÂÇ®Session„ÄÇ</li>
<li>Á≥ªÁªüËß£ËÄ¶ÔºåTokenÊê∫Â∏¶ÊâÄÊúâÁöÑÁî®Êà∑‰ø°ÊÅØÔºåÊó†ÈúÄÁªëÂÆö‰∏Ä‰∏™ÁâπÂÆöÁöÑËÆ§ËØÅÊñπÊ°àÔºåÂè™ÈúÄË¶ÅÁü•ÈÅìÂä†ÂØÜÁöÑÊñπÊ≥ïÂíåÂØÜÈí•Â∞±ÂèØ‰ª•ËøõË°åÂä†ÂØÜËß£ÂØÜÔºåÊúâÂà©‰∫éËß£ËÄ¶„ÄÇ</li>
<li>Èò≤Ê≠¢Ë∑®Á´ôÁÇπËÑöÊú¨ÊîªÂáªÔºåÊ≤°ÊúâcookieÊäÄÊúØÔºåÊó†ÈúÄËÄÉËôëË∑®Á´ôËØ∑Ê±ÇÁöÑÂÆâÂÖ®ÈóÆÈ¢ò„ÄÇ</li>
</ul>
<p><strong>3. Principle of JWT ÂéüÁêÜÁÆÄ‰ªã</strong></p>
<p>JSON Web TokensÁöÑÊ†ºÂºèÁªÑÊàêÔºåjwtÊòØ‰∏ÄÊÆµË¢´base64ÁºñÁ†ÅËøáÁöÑÂ≠óÁ¨¶Â∫èÂàóÔºåÁî®ÁÇπÂè∑ÂàÜÈöîÔºå‰∏ÄÂÖ±Áî±‰∏âÈÉ®ÂàÜÁªÑÊàêÔºåÂ§¥ÈÉ®<code>header</code>ÔºåÊ∂àÊÅØ‰Ωì<code>playload</code>ÂíåÁ≠æÂêç<code>sign</code></p>
<ul>
<li><p>Â§¥ÈÉ®<code>Header</code>ÊòØjsonÊ†ºÂºèÔºö</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"typ"</span>:<span class="string">"JWT"</span>,            <span class="comment">// ËØ•Á±ªÂûãÊòØJWTÁ±ªÂûã</span></span><br><span class="line">    <span class="string">"alg"</span>:<span class="string">"HS256"</span>,          <span class="comment">// Âä†ÂØÜÊñπÂºèÂ£∞ÊòéÊòØHS256</span></span><br><span class="line">    <span class="string">"exp"</span>:<span class="number">1491066992916</span>     <span class="comment">// expire ‰ª£Ë°®ËøáÊúüÊó∂Èó¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Ê∂àÊÅØ‰Ωì<code>Playload</code>jsonÊ†ºÂºèÔºö</p>
<p>  Ê∂àÊÅØ‰ΩìÁöÑÂÖ∑‰ΩìÂ≠óÊÆµÂèØÊ†πÊçÆ‰∏öÂä°ÈúÄË¶ÅËá™Ë°åÂÆö‰πâÂíåÊ∑ªÂä†ÔºåÂè™ÈúÄÂú®Ëß£ÂØÜÁöÑÊó∂ÂÄôÊ≥®ÊÑèÊãøÂ≠óÊÆµÁöÑkeyÂÄºËé∑Âèñvalue„ÄÇ</p>
<pre><code class="javascript">{
    <span class="string">"userid"</span>:<span class="string">"123456"</span>,
    <span class="string">"iss"</span>:<span class="string">"companyName"</span> 
}
</code></pre>
</li>
<li><p>Á≠æÂêç<code>sign</code>ÁöÑÁîüÊàê</p>
<ul>
<li>Á≠æÂêçÁöÑÁîüÊàêÊòØÊääheaderÂíåplayloadÂàÜÂà´‰ΩøÁî®base64urlÁºñÁ†Å,Êé•ÁùÄÁî®‚Äô.‚ÄòÊää‰∏§‰∏™ÁºñÁ†ÅÂêéÁöÑÂ≠óÁ¨¶‰∏≤ËøûÊé•Ëµ∑Êù•</li>
<li>ÂÜçÊääËøôÊãºÊé•Ëµ∑Êù•ÁöÑÂ≠óÁ¨¶‰∏≤ÈÖçÂêàÂØÜÈí•ËøõË°åHMAC SHA-256ÁÆóÊ≥ïÂä†ÂØÜ</li>
<li>ÁÑ∂ÂêéÂÜçÊ¨°‰ΩøÁî®base64urlÁºñÁ†ÅÔºåËøôÂ∞±ÊãøÂà∞‰∫ÜÁ≠æÂêçsign. </li>
<li>ÊúÄÂêéÊääheaderÂíåplayloadÂíåsignÁî®‚Äô.‚Äò ËøûÊé•Ëµ∑Êù•Â∞±ÁîüÊàê‰∫ÜÊï¥‰∏™JWT„ÄÇ</li>
</ul>
</li>
</ul>
<p><strong>4. Principle of JWT Checking Ê†°È™åÁÆÄ‰ªã</strong></p>
<blockquote>
<p>JWT‰∏çËÉΩ‰øùÊä§Êï∞ÊçÆÔºåÂè™ËÉΩÈ™åËØÅÊï∞ÊçÆÊòØÂê¶ÊòØÂéüÂßãÊï∞ÊçÆÔºåÊòØÂê¶Ë¢´ÁØ°ÊîπËøá</p>
</blockquote>
<p>JWTÊòØÁî±<code>header.playload.sign</code>ËøûÊé•ÁªÑÊàêÔºåÂè™ÊúâsignÊòØÁî®ÂØÜÈí•Âä†ÂØÜÁöÑÔºåËÄåÊâÄÊúâÁöÑ‰ø°ÊÅØÈÉΩÂú®headerÂíåplayload‰∏≠ÂèØ‰ª•Áõ¥Êé•Ëé∑ÂèñÔºåsignÁöÑ‰ΩúÁî®Âè™ÊòØÊ†°È™åheaderÂíåplayloadÁöÑ‰ø°ÊÅØÊòØÂê¶Ë¢´ÁØ°ÊîπËøá</p>
<ol>
<li><p>Âä†ÂØÜÔºöÊØîÂ¶ÇË¶ÅÂä†ÂØÜÈ™åËØÅÁöÑÊòØuseridÂ≠óÊÆµÔºö</p>
<ul>
<li>È¶ñÂÖàÊåâÂâçÈù¢ÁöÑÊ†ºÂºèÁªÑË£ÖjsonÊ∂àÊÅØÂ§¥headerÂíåÊ∂àÊÅØ‰ΩìplayloadÔºåÊåâheader.playloadÁªÑÊàêÂ≠óÁ¨¶‰∏≤Ôºõ</li>
<li>ÂÜçÊ†πÊçÆÂØÜÈí•ÂíåHS256Âä†ÂØÜheader.playloadÂæóÂà∞signÁ≠æÂêçÔºõ</li>
<li>ÊúÄÂêéÂæóÂà∞jwtToken‰∏∫header.playload.signÔºåÂú®httpËØ∑Ê±Ç‰∏≠ÁöÑurlÂ∏¶‰∏äÂèÇÊï∞ÊÉ≥ÂêéÁ´ØÊúçÂä°ËØ∑Ê±ÇËÆ§ËØÅ</li>
</ul>
</li>
<li><p>Ëß£ÂØÜÔºöÂêéÁ´ØÊúçÂä°Ê†°È™åjwtTokenÊòØÂê¶ÊúâÊùÉËÆøÈóÆÊé•Âè£ÊúçÂä°ÔºåËøõË°åËß£ÂØÜËÆ§ËØÅÔºåÂ¶ÇÊ†°È™åËÆøÈóÆËÄÖÁöÑuseridÔºö</p>
<ul>
<li>Áî®Â∞ÜÂ≠óÁ¨¶‰∏≤Êåâ<code>.</code>ÂàáÂàÜ‰∏âÊÆµÂ≠óÁ¨¶‰∏≤ÔºåÂàÜÂà´ÂæóÂà∞headerÂíåplayloadÂíåsign„ÄÇ</li>
<li>ÁÑ∂ÂêéÂ∞Üheader.playloadÊãºË£ÖÁî®ÂØÜÈí•ÂíåSHA-256ÁÆóÊ≥ïËøõË°åÂä†ÂØÜÁÑ∂ÂêéÂæóÂà∞Êñ∞ÁöÑÂ≠óÁ¨¶‰∏≤ÂíåsignËøõË°åÊØîÂØπÔºå</li>
<li>Â¶ÇÊûú‰∏ÄÊ†∑Â∞±‰ª£Ë°®Êï∞ÊçÆÊ≤°ÊúâË¢´ÁØ°ÊîπÔºåÁÑ∂Âêé‰ªéÂ§¥ÈÉ®ÂèñÂá∫expÂØπÂ≠òÊ¥ªÊúüËøõË°åÂà§Êñ≠</li>
<li>Â¶ÇÊûúË∂ÖËøá‰∫ÜÂ≠òÊ¥ªÊúüÂ∞±ËøîÂõûÁ©∫Â≠óÁ¨¶‰∏≤ÔºåÂ¶ÇÊûúÂú®Â≠òÊ¥ªÊúüÂÜÖËøîÂõûuseridÁöÑÂÄº</li>
</ul>
</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/17/2-egg-Puzzle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mingkai Cao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sea.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CMK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/17/2-egg-Puzzle/" itemprop="url">The Joy of Egg-Dropping(2-egg Puzzle)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-17T22:03:40-07:00">2018-05-17</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/05/17/2-egg-Puzzle/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/05/17/2-egg-Puzzle/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="I-Problem-statement"><a href="#I-Problem-statement" class="headerlink" title="I. Problem statement"></a>I. Problem statement</h3><p><strong>1. Easy version</strong></p>
<blockquote>
<p>Given infinite number of same eggs, try with minimun trials to find out  the highest floor where tossing the egg won‚Äôt result in egg crash. The building has 200 floors.</p>
</blockquote>
<ul>
<li>ÂèòÈáèÔºöN=200</li>
<li>ÁõÆÊ†áÔºöËØïÈ™åÊ¨°Êï∞ÊúÄÂ∞è</li>
<li>Á∫¶ÊùüÔºönone</li>
</ul>
<p><strong>2. Hard version</strong></p>
<blockquote>
<p>Only 2 eggs were given, try with minimun trials to find the highest floor where tossing the egg won‚Äôt result in egg crash. The building has 200 floors. (The egg can be reused as long as it is intact)</p>
</blockquote>
<ul>
<li>ÂèòÈáèÔºöF=200, E=2</li>
<li>ÁõÆÊ†áÔºöËØïÈ™åÊ¨°Êï∞ÊúÄÂ∞è</li>
<li>Á∫¶ÊùüÔºö</li>
</ul>
<h3 id="II-Solution-for-easy-version"><a href="#II-Solution-for-easy-version" class="headerlink" title="II. Solution for easy version"></a>II. Solution for easy version</h3><p>Since the number of eggs we can use is unlimited, we can use the <strong>fastest approach in the universe</strong> to find the unknown target in a list: <code>binary search</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">- left direction: break </span><br><span class="line">- right direction:intact</span><br><span class="line"></span><br><span class="line">0          100        200</span><br><span class="line">         /     \</span><br><span class="line">        50      150</span><br><span class="line">      /   \    /   \</span><br><span class="line">     25   75  125  175</span><br><span class="line">    / \  </span><br><span class="line">  ...   </span><br><span class="line"></span><br><span class="line">Toss an egg on floor 100:</span><br><span class="line">1. if egg break, toss another on floor 50;</span><br><span class="line">    1.1 if egg break, toss another on floor 25;</span><br><span class="line">        1.1.1 ...</span><br><span class="line">        1.1.2 ...</span><br><span class="line">    1.2 if doesn&apos;t break, toss another on floor 75;</span><br><span class="line">        1.2.1 ...</span><br><span class="line">        1.2.2 ...</span><br><span class="line">2. if doesn&apos;t break, toss another on floor 150;</span><br><span class="line">    2.1 if egg break, toss another on floor 125;</span><br><span class="line">        2.1.1 ...</span><br><span class="line">        2.1.2 ...</span><br><span class="line">    2.2 if doesn&apos;t break, toss another on floor 175;</span><br><span class="line">        2.2.1 ...</span><br><span class="line">        2.2.2 ...</span><br></pre></td></tr></table></figure>
<h3 id="III-Solution-for-hard-version"><a href="#III-Solution-for-hard-version" class="headerlink" title="III. Solution for hard version"></a>III. Solution for hard version</h3><p>Since it is not so intuitive at first glance, we will take a few trials to get a deeper understanding of this problem.</p>
<p>General idea:   </p>
<blockquote>
<p>egg-1 used to narrow down possible range<br>egg-2 used to sequentially find the target floor</p>
</blockquote>
<ol>
<li><p><strong>[egg-1 with step=10]</strong> egg-1 tossed on floor 20,40,60,80,100,120,‚Ä¶ with a step=20</p>
<ul>
<li>worst-case: 29 trials<ul>
<li>egg-1 tossed on 200 and break: 10 trials</li>
<li>egg-2 tossed on 199 (from 181), break: 19 trials</li>
</ul>
</li>
<li>best-case: 2 trials<ul>
<li>egg-1 tossed on 20 and break: 1 trials</li>
<li>egg-2 tossed on 1: 1 trials</li>
</ul>
</li>
<li>for this method, what is the min trials can we say?<ul>
<li>29 trials(the worst case), no worse than it</li>
<li>we cannot guarantee it is the best case</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>[edge case: BS]</strong> egg-1 tossed on floor 100, 200</p>
<ul>
<li>worst-case: 201 trials<ul>
<li>egg-1 tossed on 200 and break: 2 trials</li>
<li>egg-2 tossed on 199 (from 101), break: 199 trials</li>
</ul>
</li>
<li>best-case: 2 trials<ul>
<li>egg-1 tossed on 100 and break: 1 trials</li>
<li>egg-2 tossed on 1: 1 trials</li>
</ul>
</li>
<li>for this method, what is the min trials can we say?<ul>
<li>201 trials(the worst case), no worse than it</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>[Solution 1]</strong> </p>
<ul>
<li><a href="https://www.zhihu.com/question/19690210/answer/22937826" target="_blank" rel="noopener">https://www.zhihu.com/question/19690210/answer/22937826</a></li>
<li>the ‚Äòstep‚Äô affect min-trial</li>
<li>we want control ‚Äòstep‚Äô to make the trials of worst case and best case as close as possible; This way it will divvy up the trial between worst and best cases</li>
<li>Goal: worst case trials = best case trials</li>
<li>egg-1 tossed on floor x, 2x-1, 3x-2, .. 1</li>
<li>Ëõã‰∏ÄÁ¨¨‰∏ÄÊ¨°ÊâîÂú®XÂ±ÇÔºåÁ¨¨‰∫åÊ¨°ÊâîÂú®ÊØîÂéüÊù•È´ò X-1Â±ÇÔºå‚Ä¶ È´ò2Ôºå È´ò1Ôºå‰ΩøÂæóX+(X-1)+‚Ä¶+2+1=200</li>
<li>ÊúÄÂùèÊÉÖÂÜµ(=ÊúÄÂ•ΩÊÉÖÂÜµ)ÊÄªÁöÑÊ¨°Êï∞Â∞±ÊòØÔºö<ul>
<li>Â¶ÇÊûúÂú®Á¨¨XÂ±ÇÂ∞±Á¢éÔºåÈÇ£‰πàËõã‰∫åÊúÄÂùèÊÉÖÂÜµË¶ÅÊâîX-1ÔºåÊâÄ‰ª•ÊÄªÊï∞ÊòØ 1+X-1=X</li>
<li>Â¶ÇÊûúÂú®X+(X-1)Á¢éÔºåÈÇ£‰πàËõã‰∫åÊúÄÂùèÊÉÖÂÜµË¶ÅÊâî X-2ÔºåÊâÄ‰ª•2+X-2=X</li>
</ul>
</li>
<li><p>x = 20</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">|_|__</span><br><span class="line">|_|     x-2</span><br><span class="line">|_|__   </span><br><span class="line">|_|     x-1</span><br><span class="line">|_|___ </span><br><span class="line">|_|     x</span><br><span class="line">|_|</span><br><span class="line">|_|___</span><br></pre></td></tr></table></figure>
</li>
<li><p>ÂÅáËÆæËõã‰∏ÄÁ¨¨‰∏ÄÊ¨°ÊâîÂú®XÂ±ÇÔºåÁ¨¨‰∫åÊ¨°ÊâîÂú®ÊØîÂéüÊù•È´ò X-1Â±ÇÔºå‚Ä¶ È´ò2Ôºå È´ò1Ôºå‰ΩøÂæóX+(X-1)+‚Ä¶+2+1=100ÔºåÈÇ£‰πàÊúÄÂùèÊÉÖÂÜµÊÄªÁöÑÊ¨°Êï∞Â∞±ÊòØÔºöÂ¶ÇÊûúÂú®Á¨¨XÂ±ÇÂ∞±Á¢éÔºåÈÇ£‰πàËõã‰∫åÊúÄÂùèÊÉÖÂÜµË¶ÅÊâîX-1ÔºåÊâÄ‰ª•ÊÄªÊï∞ÊòØ 1+X-1=XÂ¶ÇÊûúÂú®X+(X-1)Á¢éÔºåÈÇ£‰πàËõã‰∫åÊúÄÂùèÊÉÖÂÜµË¶ÅÊâî X-2ÔºåÊâÄ‰ª•2+X-2=X</p>
</li>
</ul>
</li>
</ol>
<ol start="4">
<li><p><strong>[Solution 2]</strong> </p>
<ul>
<li><p>ÈìæÊé•Ôºö<a href="https://www.zhihu.com/question/19690210/answer/125713075" target="_blank" rel="noopener">https://www.zhihu.com/question/19690210/answer/125713075</a></p>
</li>
<li><p>Â≠êÈóÆÈ¢òF[i, j]: HÁöÑÂèØË°åËåÉÂõ¥‰∏∫[0, i]ÔºåÊâã‰∏äËøòÊúâj‰∏™È∏°ËõãÁöÑÊó∂ÂÄôÔºåÊúÄÂùèÊÉÖÂÜµ‰∏ãÁöÑÊúÄÂ∞èËØïÈ™åÊ¨°Êï∞ÊòØÂ§öÂ∞ë„ÄÇÊàë‰ª¨ÁöÑÁõÆÊ†áÂáΩÊï∞Â∞±ÊòØF[N, K]„ÄÇ</p>
</li>
<li>Ëøô‰∏™ËÉΩÂ§üËÆæÁ´ãÊòØÂü∫‰∫éËøôÊ†∑‰∏ÄÁßçÊÉ≥Ê≥ïÔºåÂ¶ÇÊûúHÁöÑÂèØËÉΩËåÉÂõ¥ÁõÆÂâçÊòØ[L, R]ÔºåÈÇ£‰πàÂÖ∂Áä∂ÊÄÅ‰∏é[0, R-L]ÊòØÂÆåÂÖ®‰∏ÄËá¥ÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨‰ªÖ‰ªÖËÆ∞ÂΩïÊúâÂèØË°åËåÉÂõ¥ÁöÑÂÆΩÂ∫¶Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ</li>
<li><code>F[i, j]=min{max{F[k-1, j-1], F[i-k, j]}}+1Ôºå</code><ul>
<li>ÂÖ∂‰∏≠1&lt;=k&lt;=i„ÄÇkË°®Á§∫Ëøô‰∏ÄÊ¨°ÂÆûÈ™åÊòØ‰ªékÊ•ºÊääÈ∏°ËõãÊâî‰∏ãÂéªÔºåÊâî‰∏ãÂéªÊúâ‰∏§ÁßçÁªìÊûú„ÄÇ</li>
<li>‰∏ÄÁßçÊòØÈ∏°ËõãÁ¢é‰∫ÜÔºåÈÇ£‰πàÂâ©‰ΩôÁöÑÈ∏°Ëõã‰∏™Êï∞ÊòØj-1ÔºåHÁöÑÂèØË°åËåÉÂõ¥Âèò‰∏∫[0, k-1]ÔºåÈÇ£‰πàÈúÄË¶ÅÁöÑÊúÄÂ∞ëÂÆûÈ™åÊ¨°Êï∞‰∏∫F[k-1, j-1]„ÄÇ</li>
<li>Âè¶‰∏ÄÁßçÊòØÈ∏°ËõãÊ≤°Á¢éÔºåÈÇ£‰πàÂâ©‰ΩôÁöÑÈ∏°Ëõã‰∏™Êï∞ÊòØjÔºåHÁöÑÂèØË°åËåÉÂõ¥ÊòØ[k, i]ÔºåÈÇ£‰πàÈúÄË¶ÅÁöÑÊúÄÂ∞ëÂÆûÈ™åÊ¨°Êï∞ÊòØF[k-i, j]„ÄÇ</li>
</ul>
</li>
<li>Áî±‰∫éÈ¢òÁõÆÊâÄÊ±ÇÁöÑÊòØÊúÄÂùèÊÉÖÂÜµ‰∏ãÁöÑÊúÄ‰ºòÁ≠ñÁï•ÔºåÊâÄ‰ª•ÂØπÊØèÁßçkÊÉÖÂÜµÂÜÖÂèñmaxÔºåÂÜçÂØπÊâÄÊúâkÂèñmin„ÄÇ</li>
<li>ËæπÁïåÊù°‰ª∂‰∏∫<code>F[0, j]=0ÔºåF[i, 1]=i</code>„ÄÇ</li>
<li>Êó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫O(NK^2)„ÄÇ</li>
</ul>
</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/15/React-Router-v4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mingkai Cao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sea.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CMK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/15/React-Router-v4/" itemprop="url">React Router v4</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-15T21:21:05-07:00">2018-05-15</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Full-stack/" itemprop="url" rel="index"><span itemprop="name">Full stack</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/05/15/React-Router-v4/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/05/15/React-Router-v4/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="I-Three-types-of-ComponentsÔºö"><a href="#I-Three-types-of-ComponentsÔºö" class="headerlink" title="I. Three types of ComponentsÔºö"></a>I. Three types of ComponentsÔºö</h3><p><strong>1. router components</strong></p>
<blockquote>
<p>create a history object, Êèê‰æõ‚ÄúÂâçËøõ‚Äù„ÄÅ‚ÄúÂêéÈÄÄ‚Äù</p>
</blockquote>
<ul>
<li><strong><code>&lt;BrowserRouter&gt;</code></strong>: for server that responds to requests</li>
<li><strong><code>&lt;HashRouter&gt;</code></strong>: for a static file server.</li>
</ul>
<p><strong>2. route matching components</strong></p>
<blockquote>
<p>comparing a <route>‚Äòs path prop with the current location‚Äôs pathname<br>Âè™Ë¶ÅË∑ØÁî±ÂåπÈÖçÔºåRouteÊâÄÂú®‰ΩçÁΩÆÂ∞±‰ºörenderÁõ∏Â∫îÁöÑComponent</route></p>
</blockquote>
<ul>
<li><p><strong><code>&lt;Route&gt;</code> ÔºöÂåÖÂÆπÊÄßË∑ØÁî±</strong></p>
<ul>
<li>3‰∏™propsÔºö <ul>
<li>pathÔºöÂåπÈÖçË∑ØÂæÑ</li>
<li>componentÔºöÂØπÂ∫îÁöÑÁªÑ‰ª∂</li>
<li>renderÔºöÊ≤°ÊúâÂèØÁî®ÁªÑ‰ª∂Êó∂ÔºåÁõ¥Êé•render<ul>
<li>1‰∏™stateÔºö</li>
</ul>
</li>
<li>match</li>
<li>matchÂåÖÂê´4‰∏™fieldÔºö<code>isExact</code>,<code>params</code>,<code>path</code>,<code>url</code><ul>
<li>1‰∏™contextÔºö</li>
</ul>
</li>
</ul>
</li>
<li>router obj</li>
<li>router ÂåÖÂê´ <code>history</code>,<code>routes</code></li>
</ul>
</li>
<li><p><strong><code>&lt;Switch&gt;</code>ÔºöÊéí‰ªñÊÄßË∑ØÁî±</strong></p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;Switch&gt;</span><br><span class="line">    &lt;Route exact path=<span class="string">'/'</span> component=	&#123;Home&#125;/&gt;</span><br><span class="line">    &lt;Route path=<span class="string">'/about'</span> component=&#123;About&#125;/&gt;</span><br><span class="line">    &lt;Route path=<span class="string">'/contact'</span> component=&#123;Contact&#125;/&gt;</span><br><span class="line">    &lt;Route component=&#123;NoMatch&#125;/&gt;</span><br><span class="line">&lt;<span class="regexp">/Switch&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ when none of the above match, &lt;NoMatch&gt; will be rendered</span></span><br></pre></td></tr></table></figure>
<ul>
<li>How Ôºü<br>iterate over all of its children <route> elements and only render the first one that matches the current location.</route></li>
<li>Props: <code>component</code>, <code>render</code>, and <code>children</code></li>
</ul>
</li>
</ul>
<p><strong>3. navigation components</strong></p>
<ul>
<li><strong><code>&lt;Link&gt;</code></strong></li>
<li><strong><code>&lt;NavLink&gt;</code></strong> :a special type of <link> that can style itself as ‚Äúactive‚Äù when its ‚Äòto‚Äô prop matches the current location.</li>
<li><strong><code>&lt;Redirect&gt;</code></strong>: navigate using its ‚Äòto‚Äô prop<ul>
<li>Ê≥®ÊÑèÔºö‰∏çÊòØ ‚ÄúÂáΩÊï∞‚ÄùÔºåËÄåÊòØ‚ÄúÁªÑ‰ª∂‚ÄùÔºåÈúÄË¶ÅÊîæÂú®render‰∏≠return</li>
<li>Ê≤°ÊúâË∑ØÁî±Ëß£ÊûêÊó∂ÂÄôÔºåÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®redirectÔºåÈáçÂÆöÂêëÂà∞ÈªòËÆ§È°µÈù¢</li>
</ul>
</li>
</ul>
<h3 id="II-3ÁßçÊñπÂºèrenders-Component"><a href="#II-3ÁßçÊñπÂºèrenders-Component" class="headerlink" title="II. 3ÁßçÊñπÂºèrenders Component"></a>II. 3ÁßçÊñπÂºèrenders Component</h3><ul>
<li><code>&lt;Route component&gt;</code></li>
<li><code>&lt;Route render&gt;</code></li>
<li><code>&lt;Route children&gt;</code></li>
</ul>
<h3 id="III-RouteÂú®render-componentÂêåÊó∂Ôºå‰º†ÂÖ•3‰∏™ÈáèÔºå‰Ωú‰∏∫componentÁöÑpropsÔºà‰∏çËÆ∫3‰∏≠ÊñπÂºèÁöÑÂì™‰∏ÄÁßçÔºâ"><a href="#III-RouteÂú®render-componentÂêåÊó∂Ôºå‰º†ÂÖ•3‰∏™ÈáèÔºå‰Ωú‰∏∫componentÁöÑpropsÔºà‰∏çËÆ∫3‰∏≠ÊñπÂºèÁöÑÂì™‰∏ÄÁßçÔºâ" class="headerlink" title="III. RouteÂú®render componentÂêåÊó∂Ôºå‰º†ÂÖ•3‰∏™ÈáèÔºå‰Ωú‰∏∫componentÁöÑpropsÔºà‰∏çËÆ∫3‰∏≠ÊñπÂºèÁöÑÂì™‰∏ÄÁßçÔºâ"></a>III. RouteÂú®render componentÂêåÊó∂Ôºå‰º†ÂÖ•3‰∏™ÈáèÔºå‰Ωú‰∏∫componentÁöÑpropsÔºà‰∏çËÆ∫3‰∏≠ÊñπÂºèÁöÑÂì™‰∏ÄÁßçÔºâ</h3><ul>
<li>match</li>
<li>history</li>
<li>location</li>
</ul>
<p>ÊØîÂ¶Çrender:func( )ÊñπÂºèrender conponent</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// eg1: </span></span><br><span class="line">  &lt;Route path=<span class="string">"/home"</span> render=&#123;() =&gt; <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>&#125;/&gt;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// eg2: wrapping/composing</span></span><br><span class="line">  <span class="keyword">const</span> FadingRoute = <span class="function">(<span class="params">&#123; component: Component, ...rest &#125;</span>) =&gt;</span> (</span><br><span class="line">    &lt;Route &#123;...rest&#125; render=&#123;props =&gt; (</span><br><span class="line">      &lt;FadeIn&gt;</span><br><span class="line">        &lt;Component &#123;...props&#125;/&gt;</span><br><span class="line">      &lt;<span class="regexp">/FadeIn&gt;</span></span><br><span class="line"><span class="regexp">    )&#125;/</span>&gt;</span><br><span class="line">  )</span><br><span class="line">  </span><br><span class="line">  &lt;FadingRoute path=<span class="string">"/cool"</span> component=&#123;Something&#125;/&gt;<span class="string">"</span></span><br><span class="line"><span class="string">  - render props: path„ÄÅchildrenÔºèrenderÔºècomponent„ÄÅ</span></span><br><span class="line"><span class="string">  - render stateÔºömatch</span></span><br><span class="line"><span class="string">  - component props(routeÊâÄrender): history„ÄÅlocation„ÄÅmatch</span></span><br><span class="line"><span class="string">    "</span>‰∏çËÆ∫ÊòØÂì™ÁßçÊñπÂºèrenderÔºåÈÉΩ‰ºöÊãøÂà∞Ëøô‰∏â‰∏™props<span class="string">"</span></span><br><span class="line"><span class="string">  - Âõ†Ê≠§Ôºåeg2‰∏≠render:funcÊñπÂºèÔºåÁõ¥Êé•Â∞Üprops‰Ωú‰∏∫function componentÁöÑÂèÇÊï∞‰º†ÂÖ•</span></span><br><span class="line"><span class="string">    "</span>render=&#123; props =&gt; (</span><br><span class="line">        &lt;FadeIn&gt;</span><br><span class="line">          &lt;Component &#123;...props&#125;/&gt;</span><br><span class="line">        &lt;<span class="regexp">/FadeIn&gt;</span></span><br><span class="line"><span class="regexp">      )&#125;"</span></span><br></pre></td></tr></table></figure>
<h3 id="IV-Route-vs-ComponentÂ¶Ç‰ΩïÂÖ≥ËÅî"><a href="#IV-Route-vs-ComponentÂ¶Ç‰ΩïÂÖ≥ËÅî" class="headerlink" title="IV. Route vs ComponentÂ¶Ç‰ΩïÂÖ≥ËÅî"></a>IV. Route vs ComponentÂ¶Ç‰ΩïÂÖ≥ËÅî</h3><ul>
<li>Router Â∞ÜË∑ØÂæÑ match‰∏ä‰πãÂêéÔºå‰ºöË∞ÉÁî®Áõ∏Â∫îÁöÑ RouteÔºå Áî±Route Â∞ÜÁõ∏ÂÖ≥ÁöÑÂèÇÊï∞Ôºömatch„ÄÅlocation„ÄÅhistoryÁ≠â‰º†ÂÖ•Âà∞ Component‰∏≠</li>
<li>Route ÁöÑ state: match„ÄÅlocation ‰º†ÂÖ•Âà∞ ComponentÁöÑ props: match„ÄÅlocation</li>
<li>The Route will render <dashboard {...props}=""> , where props are some router specific things that look like { match, location, history }. </dashboard></li>
<li>If the user is not at /dashboard then the Route will render null. That‚Äôs pretty much all there is to it.</li>
</ul>
<h3 id="V-match-url-vs-match-path"><a href="#V-match-url-vs-match-path" class="headerlink" title="V. match.url vs match.path"></a>V. <code>match.url</code> vs <code>match.path</code></h3><blockquote>
<p>A match object contains information about how a <route path=""> matched the URL.</route></p>
</blockquote>
<ul>
<li>matchÔºöÊòØ <code>route</code>ÁöÑ<code>state</code>ÔºõÊòØ<code>component</code>ÁöÑ<code>props</code></li>
<li>Eg: consider the route <code>/users/:userId</code><ul>
<li><code>match.path</code> - (string) Áî®‰∫éÂåπÈÖçË∑ØÂæÑÊ®°Âºè„ÄÇÁî®‰∫éÊûÑÂª∫ÂµåÂ•óÁöÑ <route>; <code>match.path</code> would be <code>/users/:userId</code></route></li>
<li><code>match.url</code> - (string) URL ÂåπÈÖçÁöÑÈÉ®ÂàÜ„ÄÇ Áî®‰∫éÊûÑÂª∫ÂµåÂ•óÁöÑ <link>; <code>match.url</code> would have the :userId value filled in, e.g. ‚Äúusers/5‚Äù.‚Äù</li>
</ul>
</li>
</ul>
<h3 id="VI-match-params-Ë°®Á§∫-url-ÂåπÈÖç‰∏äÁöÑÂèòÈáèÂÄº"><a href="#VI-match-params-Ë°®Á§∫-url-ÂåπÈÖç‰∏äÁöÑÂèòÈáèÂÄº" class="headerlink" title="VI. match.params Ë°®Á§∫ url ÂåπÈÖç‰∏äÁöÑÂèòÈáèÂÄº"></a>VI. <code>match.params</code> Ë°®Á§∫ url ÂåπÈÖç‰∏äÁöÑÂèòÈáèÂÄº</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Route path=<span class="string">"/:id"</span> component=&#123;Child&#125; /&gt;</span><br><span class="line"></span><br><span class="line">&#123;match.params.id&#125;</span><br></pre></td></tr></table></figure>
<p>URL ÂêéÂçäÈÉ®ÂàÜÁî±ÂèòÈáè id ÂÖú‰ΩèÔºåÂ¶ÇÊûúËøõÊù•ÁöÑurl‰∏∫<code>/abc</code>ÔºåÈÇ£‰πà <code>match.params.id = abc</code></p>
<h3 id="VII-Eg-Custom-Link"><a href="#VII-Eg-Custom-Link" class="headerlink" title="VII. Eg: Custom Link"></a>VII. Eg: Custom Link</h3><blockquote>
<p>RouteÂÆûÈôÖ‰∏äÊòØ Component ÁöÑ‰π∞ÂäûÔºå‰∏∫ComponentÂäû‰∫ãÔºÅ<br>RouteÊîæÂú®Âì™‰∏™‰ΩçÁΩÆÔºåÈÇ£ÈáåÂ∞±ÊúâÂèØËÉΩrenderÂá∫ÂÆÉÊê∫Â∏¶ÁöÑcomponent(Âè™Ë¶Åurl match)</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Route path=<span class="string">"/abc"</span> component=&#123;Child_1&#125; /&gt;</span><br><span class="line">&lt;Route path=<span class="string">"/abc"</span> component=&#123;Child_2&#125; /&gt;</span><br><span class="line">&lt;Route path=<span class="string">"/abc"</span> component=&#123;Child_3&#125; /&gt;</span><br></pre></td></tr></table></figure>
<h3 id="VIII-lt-Prompt-gt-ÔºöÈò≤Ê≠¢‰∏≠ÈÄîË∑≥ËΩ¨"><a href="#VIII-lt-Prompt-gt-ÔºöÈò≤Ê≠¢‰∏≠ÈÄîË∑≥ËΩ¨" class="headerlink" title="VIII. &lt;Prompt&gt;ÔºöÈò≤Ê≠¢‰∏≠ÈÄîË∑≥ËΩ¨"></a>VIII. <code>&lt;Prompt&gt;</code>ÔºöÈò≤Ê≠¢‰∏≠ÈÄîË∑≥ËΩ¨</h3><blockquote>
<p>ÈÄÇÁî®ÊÉÖÂÜµÔºöÁî®Êà∑Âú®Â°´Ë°®ËøáÁ®ã‰∏≠ÔºåÁÇπÂáª‰∫Ü‚ÄúÂêéÈÄÄ‚ÄùÊàñ‚ÄúË∑≥ËΩ¨ÈìæÊé•‚ÄùÔºåÈúÄÂºπÁ™óËØ¢ÈóÆ<br><code>&lt;Prompt&gt;</code>ÊòØ‰øùÁïôtagÔºåË∑ü<code>&lt;Link&gt;</code>‰∏ÄÊ†∑</p>
</blockquote>
<ul>
<li>ÂàõÂª∫‰∏Ä‰∏™wrapperÔºåÂåÖÂê´<code>&lt;form&gt;</code>, <code>&lt;Prompt&gt;</code></li>
<li>wrapper‰∏≠ËÆæÁΩÆ<code>state.inMiddle</code>ÔºåÊù•ÂÜ≥ÂÆöÊòØÂê¶render<code>&lt;Prompt&gt;</code></li>
<li>ÊîπÂèò<code>state.inMiddle</code>ÁöÑÊ†πÊ∫êÔºö<code>form</code>‰∏≠ÁöÑ<code>input</code>ËæìÂÖ•Ê°ÜÔºõ<ul>
<li>Âè™Ë¶ÅÊúâ‰ªª‰ΩïËæìÂÖ•ÂÄºÔºåÂ∞±Â∞Ü<code>state.inMiddle</code>ÁΩÆ‰∏∫<code>true</code></li>
<li>Êèê‰∫§formÂêéÔºåÂ∞Üform reset()‰πãÂêéÔºåÈúÄË¶ÅÂ∞Ü<code>state.inMiddle</code>ÁΩÆ‰∏∫<code>false</code></li>
</ul>
</li>
<li><code>Prompt</code>ÁöÑprops:<ul>
<li><code>when</code>ÔºöÊ£ÄÊü•<code>state.inMiddle</code></li>
<li><code>message</code>: ÂÜ≥ÂÆöÂºπÁ™óÁöÑÊòæÁ§∫‰ø°ÊÅØ</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Form</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    isBlocking: <span class="literal">false</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; isBlocking &#125; = <span class="keyword">this</span>.state;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;form</span><br><span class="line">        onSubmit=&#123;event =&gt; &#123;</span><br><span class="line">          event.preventDefault();</span><br><span class="line">          event.target.reset();</span><br><span class="line">          <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            isBlocking: <span class="literal">false</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;&#125;</span><br><span class="line">        &gt;</span><br><span class="line">        </span><br><span class="line">        &lt;Prompt</span><br><span class="line">          when=&#123;isBlocking&#125;</span><br><span class="line">          message=&#123;location =&gt;</span><br><span class="line">            <span class="string">`Are you sure you want to go to <span class="subst">$&#123;location.pathname&#125;</span>`</span></span><br><span class="line">          &#125;</span><br><span class="line">        /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;input</span><br><span class="line">        placeholder=<span class="string">"type something"</span></span><br><span class="line">        onChange=&#123;event =&gt; &#123;</span><br><span class="line">          <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            isBlocking: event.target.value.length &gt; <span class="number">0</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        &lt;button&gt;Submit&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">      &lt;/</span>form&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul>
<li>Official API: <a href="https://reacttraining.com/react-router/web/guides/philosophy" target="_blank" rel="noopener">https://reacttraining.com/react-router/web/guides/philosophy</a></li>
<li>‰∏≠ÊñáÁâàAPIÔºö<a href="https://www.jianshu.com/p/e3adc9b5f75c" target="_blank" rel="noopener">https://www.jianshu.com/p/e3adc9b5f75c</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/sea.jpg"
                alt="Mingkai Cao" />
            
              <p class="site-author-name" itemprop="name">Mingkai Cao</p>
              <p class="site-description motion-element" itemprop="description">All-trade Jack, loves full-stack</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">46</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">5</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">62</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/caomingkai" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:mingkaic@usc.edu" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate"> 
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mingkai Cao</span>

  

  
</div>




  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Mist</a> v6.0.6</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="Total Visitors">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="Total Views">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.6"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.6"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.6"></script>



  



	





  





  








  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  
  
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>

  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick';
    guest = guest.split(',').filter(function (item) {
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'hG8fgggWL7hK1jsXsRoVCNWv-MdYXbMMI',
        appKey: 'VRAYsgwdkRyyb8bAFQ5uii6o',
        placeholder: 'Any comment?',
        avatar:'',
        guest_info:guest,
        pageSize:'10' || 10,
    });
    // Êñ∞Â¢û‰ª•‰∏ã‰ª£Á†ÅÂç≥ÂèØÔºåÂèØ‰ª•ÁßªÈô§.info‰∏ãÊâÄÊúâÂ≠êËäÇÁÇπ
    var infoEle = document.querySelector('#comments .info');
    if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0){
      infoEle.childNodes.forEach(function(item) {
        item.parentNode.removeChild(item);
      });
    }


  </script>



  





  

  

  

  

  
  

  

  

  

  


<style>
    #comments .vempty{
        display: none;
    }
</style>

</body>
</html>
