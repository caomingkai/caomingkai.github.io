<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.0.6" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.6">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.6">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.6">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.6" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.0.6',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Jack of all trades, master of one">
<meta property="og:type" content="website">
<meta property="og:title" content="CMK">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="CMK">
<meta property="og:description" content="Jack of all trades, master of one">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CMK">
<meta name="twitter:description" content="Jack of all trades, master of one">






  <link rel="canonical" href="http://yoursite.com/page/3/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>CMK</title>
  




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-116541729-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116541729-1');
</script>






  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-right 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> 

<div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">CMK</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Let's create something!</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
          
  <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Home</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />Categories</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />Tags</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archives</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />About</a>
</li>

      

      
    </ul>
  

  

  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/27/Binary-Search-variations/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mingkai Cao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sea.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CMK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/27/Binary-Search-variations/" itemprop="url">Binary Search variations</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-27T09:12:32-07:00">2018-03-27</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/03/27/Binary-Search-variations/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/03/27/Binary-Search-variations/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong><em>Credit to : <a href="http://izualzhy.cn/algorithm/2014/04/18/binary-search-analysis" target="_blank" rel="noopener">http://izualzhy.cn/algorithm/2014/04/18/binary-search-analysis</a></em></strong></p>
<h2 id="I-二分法及变种的注意点："><a href="#I-二分法及变种的注意点：" class="headerlink" title="I. 二分法及变种的注意点："></a>I. 二分法及变种的注意点：</h2><h4 id="1-如何得到循环不变式"><a href="#1-如何得到循环不变式" class="headerlink" title="1. 如何得到循环不变式"></a>1. 如何得到循环不变式</h4><p>【定义】就是在每次循环里，我们都可以保证要找的index在我们新构造 的区间里。<br>【例子】如正常二分法，循环不变式表述如下：  </p>
<pre><code>if array[mid] &gt; key:
    right = mid - 1
 else if array[mid] &lt; key:
     left = mid + 1
 else
     return mid
</code></pre><p>考虑中间值与key的关系： </p>
<ul>
<li>如果中间值比key大，那么[mid, right]的值我们都可以忽略掉了，这些值都比key要大。只要在[left, mid-1]里查找就是了。</li>
<li>如果中间值比key小，那么[left, mid]的值可以 忽略掉，这些值都比key要小，只要在[mid+1, right]里查找就可以了。</li>
<li>如果相等，表示找到了，可以直接返回。如果最后这个区间没有，那么就确实是没有 。所以说循环不变式，就是在每次循环里，我们都可以保证要找的index在我们新构造的区间里</li>
</ul>
<h4 id="2-数组是非递增还是非递减"><a href="#2-数组是非递增还是非递减" class="headerlink" title="2. 数组是非递增还是非递减"></a>2. 数组是非递增还是非递减</h4><h4 id="3-结束条件，即while-condition-应当是-lt-还是-lt"><a href="#3-结束条件，即while-condition-应当是-lt-还是-lt" class="headerlink" title="3. 结束条件，即while (condition) 应当是&lt;还是&lt;="></a>3. 结束条件，即while (condition) 应当是&lt;还是&lt;=</h4><pre><code>“&lt; ” 表明可选区间长度 2～n ；  OR    
“&lt;= ” 表明可选区间长度 1～n 
</code></pre><h4 id="4-求mid应当是向上取整还是向下取整"><a href="#4-求mid应当是向上取整还是向下取整" class="headerlink" title="4. 求mid应当是向上取整还是向下取整"></a>4. 求mid应当是向上取整还是向下取整</h4><pre><code>mid = (left + right) &gt;&gt;1       OR
mid = (left + right + 1) &gt;&gt;1
</code></pre><h4 id="5-while-结束后是否需要判断一次条件"><a href="#5-while-结束后是否需要判断一次条件" class="headerlink" title="5.  while 结束后是否需要判断一次条件"></a>5.  while 结束后是否需要判断一次条件</h4><pre><code>对应可选区间为2～n情况，将所有元素check完毕；  
同时，调整mid取整方式，使该判断优雅
</code></pre><hr>
<h2 id="II-常见问题："><a href="#II-常见问题：" class="headerlink" title="II. 常见问题："></a>II. 常见问题：</h2><h4 id="1-查找值key的下标，如果不存在返回-1"><a href="#1-查找值key的下标，如果不存在返回-1" class="headerlink" title="1. 查找值key的下标，如果不存在返回-1."></a>1. 查找值key的下标，如果不存在返回-1.</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BS</span><span class="params">(<span class="keyword">const</span> Vec Int&amp; vec, <span class="keyword">int</span> key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = vec.size() - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (left &lt;= right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (vec[mid] &gt; key)</span><br><span class="line">            right = mid - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (vec[mid] &lt; key)</span><br><span class="line">            left = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> mid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>如果中间值比key大，那么[mid, right]的值我们都可以忽略掉了，这些值都比key要大。只要在[left, mid-1]里查找就是了。</li>
<li>如果中间值比key小，那么[left, mid]的值可以 忽略掉，这些值都比key要小，只要在[mid+1, right]里查找就可以了。</li>
<li>如果相等，表示找到了， 可以直接返回。</li>
</ul>
<p>因此，循环不变式就是在每次循环里，我们都可以保证要找的index在我们新构造 的区间里。如果最后这个区间没有，那么就确实是没有。<br><strong>注意mid的求法</strong>，可能会int越界，但我们先不用考虑这个问题，要记住的是这点：<u>mid是偏向left的，即如果left=1,right=2,则mid=1。</u></p>
<h4 id="2-查找值key第一次出现的下标x，如果不存在返回-1"><a href="#2-查找值key第一次出现的下标x，如果不存在返回-1" class="headerlink" title="2. 查找值key第一次出现的下标x，如果不存在返回-1."></a>2. 查找值key第一次出现的下标x，如果不存在返回-1.</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BS_First</span><span class="params">(<span class="keyword">const</span> VecInt&amp; vec, <span class="keyword">int</span> key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = vec.size() - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right)                 <span class="comment">//问题1，left &lt; right时继续，相等就break.</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (vec[mid] &lt; key)</span><br><span class="line">            left = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            right = mid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (vec[left] == key)               <span class="comment">//问题2,再判断一次。</span></span><br><span class="line">        <span class="keyword">return</span> left;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们仍然考虑中间值与key的关系：</p>
<ul>
<li>如果array[mid]&lt;key，那么x一定在[mid+1, right]区间里。</li>
<li>如果array[mid]&gt;key，那么x一定在[left, mid-1]区间里。</li>
<li>如果array[mid]≤key，那么不能推断任何关系。比如对key=1,数组{0,1,1,2,3},{0,0,0,1,2},array[mid] = array[2] ≤ 1，但一个在左半区间，一个在右半区间。</li>
<li>如果array[mid]≥key，那么x一定在[left, mid]区间里。</li>
<li>综合上面的结果，我们可以采用1,4即&lt;和≥的组合判断来实现我们的循环不变式，即循环过程中一直满足key在我们的区间里。</li>
</ul>
<p><strong>注意问题：</strong></p>
<ul>
<li>循环能否退出,我们注意到4的区间改变里是令right = mid,如果left=right=mid时，循环是无法退出的。换句话说，第一个问题我们始终在减小着区间，而在这个问题里，某种情况下区间是不会减小的！ —– 见代码</li>
<li>循环退出后的判断问题，再看下我们的条件1,4组合，只是使得我们最后的区间满足了≥key，是否=key，还需要再判断一次。 —– 见代码</li>
</ul>
<h4 id="3-查找值key最后一次出现的下标x，如果不存在返回-1"><a href="#3-查找值key最后一次出现的下标x，如果不存在返回-1" class="headerlink" title="3. 查找值key最后一次出现的下标x，如果不存在返回-1."></a>3. 查找值key最后一次出现的下标x，如果不存在返回-1.</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BS_Last</span><span class="params">(<span class="keyword">const</span> VecInt&amp; vec, <span class="keyword">int</span> key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = vec.size() - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (left + right + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (vec[mid] &gt; key)</span><br><span class="line">            right = mid - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            left = mid;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (vec[left] == key)</span><br><span class="line">        <span class="keyword">return</span> left;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>循环不变式（省去分析的过程，同上）：</p>
<ul>
<li>如果array[mid]&gt;key，那么x一定在[left, mid-1]区间里。</li>
<li>如果array[mid]≤key, 那么x一定在[mid, right]区间里。</li>
</ul>
<p><strong>注意问题：</strong></p>
<ul>
<li>在条件2里，实际上我们是令left=mid，但是如前面提到的，如果left=1,right=2,那么mid=left=1，同时又进入到条件2,left=mid=1，即使我们在while设定了left &lt; right仍然无法退出循环，</li>
<li>解决的办法很简单：mid = (left + right + 1) &gt;&gt; 1， 向上取整就可以了。</li>
</ul>
<h4 id="4-查找刚好小于key的元素下标x，如果不存在返回-1"><a href="#4-查找刚好小于key的元素下标x，如果不存在返回-1" class="headerlink" title="4. 查找刚好小于key的元素下标x，如果不存在返回-1."></a>4. 查找刚好小于key的元素下标x，如果不存在返回-1.</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BS_Last_Less</span><span class="params">(<span class="keyword">const</span> VecInt&amp; vec, <span class="keyword">int</span> key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = vec.size() - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (left + right + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (vec[mid] &lt; key)</span><br><span class="line">            left = mid;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            right = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (vec[left] &lt; key)</span><br><span class="line">        <span class="keyword">return</span> left;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>循环不变式（省去分析的过程，同上）：</p>
<ul>
<li>如果array[mid]&lt;key，那么x在区间[mid, right]</li>
<li>如果array[mid]≥key，那么x在区间[left, mid-1]</li>
</ul>
<h4 id="5-查找刚好大于key的元素下标x，如果不存在返回-1-等价于std-upper-bound"><a href="#5-查找刚好大于key的元素下标x，如果不存在返回-1-等价于std-upper-bound" class="headerlink" title="5. 查找刚好大于key的元素下标x，如果不存在返回-1,等价于std::upper_bound."></a>5. 查找刚好大于key的元素下标x，如果不存在返回-1,等价于std::upper_bound.</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BS_First_Greater</span><span class="params">(<span class="keyword">const</span> VecInt&amp; vec, <span class="keyword">int</span> key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = vec.size() - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (vec[mid] &gt; key)</span><br><span class="line">            right = mid;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            left = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (vec[left] &gt; key)</span><br><span class="line">        <span class="keyword">return</span> left;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>循环不变式（省去分析的过程，同上）：</p>
<ul>
<li>如果array[mid]&gt;key，那么x在区间[left, mid]</li>
<li>如果array[mid]≤key，那么x在区间[mid + 1, right]</li>
</ul>
<h4 id="6-查找第一个-gt-key的下标，如果不存在返回-1-等价于std-lower-bound"><a href="#6-查找第一个-gt-key的下标，如果不存在返回-1-等价于std-lower-bound" class="headerlink" title="6. 查找第一个&gt;=key的下标，如果不存在返回-1,等价于std::lower_bound."></a>6. 查找第一个&gt;=key的下标，如果不存在返回-1,等价于std::lower_bound.</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BS_First_Greater_Or_Equal</span><span class="params">(<span class="keyword">const</span> VecInt&amp; vec, <span class="keyword">int</span> key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = vec.size() - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (vec[mid] &lt; key)</span><br><span class="line">            left = mid +<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            right = mid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (vec[left] &gt;= key)</span><br><span class="line">        <span class="keyword">return</span> left;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>循环不变式（省去分析的过程，同上）：</p>
<ul>
<li>如果array[mid]&lt;key，那么x在区间[mid + 1, right]</li>
<li>如果array[mid]≥key，那么x在区间[left, mid]</li>
</ul>
<hr>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/26/Tiny-URL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mingkai Cao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sea.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CMK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/26/Tiny-URL/" itemprop="url">Tiny URL</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-26T11:14:49-07:00">2018-03-26</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Portfolios/" itemprop="url" rel="index"><span itemprop="name">Portfolios</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/03/26/Tiny-URL/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/03/26/Tiny-URL/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="I-Introduction"><a href="#I-Introduction" class="headerlink" title="I. Introduction"></a>I. Introduction</h2><p>A MEAN stack Single Page Application, providing:</p>
<ol>
<li>URL shortening service</li>
<li>Traffic statistics collecting service</li>
</ol>
<p>Tech stacks: <strong>AngularJS, Node.js, Express, MongoDB, Redis, Nginx, Docker</strong></p>
<p>Github: <a href="https://github.com/caomingkai/URL-shortening-service" target="_blank" rel="noopener">https://github.com/caomingkai/URL-shortening-service</a></p>
<p><a href="https://tinyurl-199300.appspot.com/#/" target="_blank" rel="noopener"><br>    <img src="/2018/03/26/Tiny-URL/tinyURL.png" title="This is an image"><br></a></p>
<h2 id="II-Work-flow"><a href="#II-Work-flow" class="headerlink" title="II. Work flow"></a>II. Work flow</h2><h4 id="1-Users-come-to-the-app-webpage"><a href="#1-Users-come-to-the-app-webpage" class="headerlink" title="1. Users come to the app webpage"></a>1. Users come to the app webpage</h4><ul>
<li>Browser send GET request with original URL to server</li>
<li>Server sends index.html to clients</li>
<li>Browser get the index.html with script in the head tag.<br><code>&lt;script src=&#39;angularJS library &#39;&gt; &lt;script src=&#39;app.js&#39;&gt; &lt;script src=&#39;/public/js/controllers/homeController.js&#39;&gt;</code></li>
<li>Browser again sends request for angularJS library/ js controller files to different servers</li>
<li>when browser encounter ‘ng-view’, it automatically turn to ‘ng-router’, ask for its view and controller; Again, sends corresponding GET request to fetch sub-view files</li>
<li>while browser parse the controller js file, it might do AJAX request to fetch information from server.</li>
</ul>
<h4 id="2-Users-use-the-shortening-service"><a href="#2-Users-use-the-shortening-service" class="headerlink" title="2. Users use the shortening service"></a>2. Users use the shortening service</h4><ul>
<li>Input longURL in the input box, and click ‘submit’</li>
<li>‘submit’ fires the onclick funcion to do 2 things:<ul>
<li>send the longURL to specified URL, ie. POST  to localhost/api/v1/urls<br><code>NOTICE: This url is specifically used for rendering short/long URL</code></li>
<li>send the longURL to specified URL, ie. POST  to localhost/api/v1/urls<br><code>NOTICE: this step is executed after app server responds the POST request in the first step with the calculated shortURL</code></li>
</ul>
</li>
<li>App server first receive the POST request with longURL, do 2 things: call the urlService to calculate the shortURL, store long/short URL pair in MongoDB;send back the shortURL to the app webpage.<br><code>NOTICE: the shortURL should consist different prefix compared with the current app URL. Because it is create for outside users. So the shortURL should not prefix with /api/v1/.., but with just &#39;/:shortUrl&#39;</code></li>
<li>After the app webpage getting shortURL, it renders new subview using url.html; Meanwhile, it needs to know the its original longURL for display.</li>
<li>Again, in the url.html subview, it sends GET request to the app server to get the longURL<br>Notice: This step could be simplified by just passing the longURL from the first subview to the second subview creating a service or using the $rootScop</li>
<li>Now, in the new subview, the longURL and shortURL pair can be displayed</li>
</ul>
<h4 id="3-Visitors-browse-the-shortURL"><a href="#3-Visitors-browse-the-shortURL" class="headerlink" title="3. Visitors browse the shortURL"></a>3. Visitors browse the shortURL</h4><ul>
<li>the shortURL is just clicked from various browsers/ machines/ from different IP/ countries, at different time</li>
<li>when shortURL is clicked, it sends GET request ‘localhost/:shortUrl’ to the app server.</li>
<li>the app sever call the urlService to get the longURL from the shortURL, and redirect users to the original long URL</li>
</ul>
<h4 id="4-Traffic-statistics-Info"><a href="#4-Traffic-statistics-Info" class="headerlink" title="4. Traffic statistics Info"></a>4. Traffic statistics Info</h4><ul>
<li>We want to record the total number of clicks / their browsers/ machine brands/ their IP/ countries/ timestamp. And display them in the app webpage.</li>
<li>So first we need add more elements in the url.html subview in the frontend; And update those information in the backend.<ul>
<li>updating the info each time the shortURL is clicked. And then store them in the MongoDB</li>
<li>when app webpage is clicked, make AJAX call to the app server, let it get the info from MongoDB, and then send back to frontend</li>
</ul>
</li>
<li>Since all these clicks directly send GET request to ‘localhost/:shortURL’, which is handled by redirect.js. Thus, we here need a statistic service to update these info.</li>
<li>Here we need the one of Express modules: Express-useragent to extract the information from the request</li>
<li>In the statistic service, we use the express-useragent to get the info, and then store them in the MongoDB database with a new schema.</li>
</ul>
<h2 id="III-Nginx"><a href="#III-Nginx" class="headerlink" title="III. Nginx"></a>III. Nginx</h2><h4 id="Reverse-Proxy"><a href="#Reverse-Proxy" class="headerlink" title="Reverse Proxy"></a>Reverse Proxy</h4><ul>
<li>(正向)代理forward proxy: 在client与internet之间，替client访问internet的计算机<ul>
<li>路由器就是一个forward proxy，外网看不到路由器之后的计算机，但是计算机可以看到外边</li>
<li>翻墙服务器</li>
</ul>
</li>
<li>(反向)代理:在server与internet之间，替server接受internet访问的计算机</li>
</ul>
<h4 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h4><ul>
<li>Hide Original server<br>“安全”</li>
<li>application firewall</li>
<li>SSL termination: “加密不需要server进行，反向代理可以代为计算以减轻server压力”</li>
<li>Load balance<ol>
<li>round robin<br>“optionally weighted”</li>
<li>least connected<br>“optionally weighted”</li>
<li>IP hash<br>“1~200: server a; 201~400: server b”</li>
<li>Generic Hash<br>“based on devices/ client locations”</li>
<li>Least time (nginx plux)<br>“optionally weighted”</li>
</ol>
</li>
<li>Cache<ul>
<li>GET 都可以cache</li>
<li>即便是动态列表也进行cache，因为实际生活的改变不会比nginx的处理快 “1s <---> 100000 request/s”</---></li>
<li>POST不能cache</li>
</ul>
</li>
<li>Compression(gzip)<br>“减小网络传输量: 用reverse proxy/ browser 的CPU为代价”</li>
<li>不宕机进行配置改变／升级</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/20/React-Router/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mingkai Cao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sea.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CMK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/20/React-Router/" itemprop="url">React Router</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-20T22:48:46-08:00">2018-01-20</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-end/" itemprop="url" rel="index"><span itemprop="name">Front end</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/01/20/React-Router/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/01/20/React-Router/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="React-Componet：2-ways"><a href="#React-Componet：2-ways" class="headerlink" title="React Componet：2 ways"></a>React Componet：2 ways</h2><ol>
<li>stateless component<ul>
<li>no lifecycle; <strong>reentrant</strong>: can be passed like value</li>
<li>use <code>function</code> to create a component </li>
</ul>
</li>
<li>stateful component<ul>
<li>has lifecycle; <strong>non-reentrant</strong></li>
<li>extends <code>React.Component</code> class</li>
</ul>
</li>
</ol>
<h2 id="BrowserRouter-Route-Link"><a href="#BrowserRouter-Route-Link" class="headerlink" title="BrowserRouter, Route, Link"></a>BrowserRouter, Route, Link</h2><ul>
<li>Router: 具有“路由”功能的component</li>
<li>Route:</li>
<li>Link: </li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/10/ES6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mingkai Cao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sea.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CMK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/10/ES6/" itemprop="url">ES6</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-10T20:21:44-08:00">2018-01-10</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-end/" itemprop="url" rel="index"><span itemprop="name">Front end</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/01/10/ES6/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/01/10/ES6/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="I-JavaScript-is-OOP"><a href="#I-JavaScript-is-OOP" class="headerlink" title="I. JavaScript is OOP"></a>I. JavaScript is OOP</h2><blockquote>
<p>JS的始末、与Java的区别：<a href="https://juejin.im/entry/5975e76af265da6c2a74bc45" target="_blank" rel="noopener">https://juejin.im/entry/5975e76af265da6c2a74bc45</a></p>
</blockquote>
<p>JavaScript 是一种基于原型实现的面向对象的语言， 根本没有类的概念，全是 object ！</p>
<ol>
<li>通过 “prototype” 以及 “<em>proto</em>“ 来实现：类的继承<ul>
<li>“prototype” 以及 “<em>proto</em>“ 重要性：<a href="https://juejin.im/entry/5975e76af265da6c2a74bc45" target="_blank" rel="noopener">https://juejin.im/entry/5975e76af265da6c2a74bc45</a></li>
</ul>
</li>
<li>“函数／function”是一等公民，ie. is also an object <ul>
<li>实际上说的是它们和其他对象object都一样，也有自己的method，也可以被当作参数被传入／传出</li>
</ul>
</li>
<li><p>如何创在object对象—直接造！</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line"><span class="keyword">var</span> animal = &#123;</span><br><span class="line">	name : <span class="string">'animal'</span>,</span><br><span class="line">	eat : <span class="function"><span class="keyword">function</span>(<span class="params"> </span>)</span>&#123;</span><br><span class="line">			<span class="built_in">console</span>.log( <span class="keyword">this</span>.name + <span class="string">'is eating'</span>);</span><br><span class="line">                &#125;</span><br><span class="line">&#125;</span><br><span class="line">animal.eat( ) <span class="comment">// animal is eating"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>题外话： 由于对象并不和类关联， 我们可以随意地给这个对象增加属性！</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">animal.color = <span class="string">'black'</span>;   </span><br><span class="line"><span class="comment">// animal 现在多了一个 color 的属性</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>prototype: 继承</p>
<ul>
<li>继承：就是让两个对象建立关联！  </li>
<li>每个对象都有一个特殊的属性叫做<strong>proto</strong>， 可以用这个属性去关联另外一个对象（这个对象就是所谓的原型了）</li>
<li><p>例子：</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"var dog&#123;</span></span><br><span class="line"><span class="string">	name = 'dog';</span></span><br><span class="line"><span class="string">	_proto_ = animal;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">var cat&#123;</span></span><br><span class="line"><span class="string">	name = 'cat';</span></span><br><span class="line"><span class="string">	_proto_ = animal;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">dog.eat( ); // dog is eating</span></span><br><span class="line"><span class="string">cat.eat( );   // cat is eating"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>例子分析：</p>
<ul>
<li>对象dog 的原型是animal (注意：也是一个对象)，  对象cat的原型也是animal 。</li>
<li>无论是dog还是cat ，都没有定义eat()方法， 那怎么可以调用呢？</li>
<li>当eat方法被调用的时候，先在自己的方法列表中寻找， 如果找不到，就去找原型中的方法， 如果原型中找不到， 就去原型的原型中去寻找……   最后找到Object那里， 如果还找不到， 那就是未定义了。</li>
</ul>
</li>
<li>与Java 联系：<ul>
<li>JVM虚拟机的时候， 也提到了一个对象在执行方法的时候，需要查找方法的定义，这个查找的次序也是先从本对象所属的类开始， 然后父类， 然后父类的父类…… 直到Object,  思路是一模一样的！</li>
<li>只不过Java 的方法定义是在class中， 而这个javascript 的方法就在对象里边， 现在我觉得似乎在对象里更加直观一点啊。</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="II-OOP的4个特性："><a href="#II-OOP的4个特性：" class="headerlink" title="II. OOP的4个特性："></a>II. OOP的4个特性：</h2><ul>
<li><strong>封装(encapsulation)</strong>：把相关信息，无论数据或方法都存储在一个对象中的能力。</li>
<li><strong>聚合(combination)</strong>：将一个对象存储在另一个对象中的能力。(LinkedList <--> Node)</--></li>
<li><strong>继承(inheritance)</strong>：一个类依赖另一个类 （ 或一些类 ）中的一些性质和方法的能力。</li>
<li><strong>多态(polymorphism)</strong>：写一个函数或方法，他可以以各种不同形式工作的能力。</li>
</ul>
<h2 id="III-var-vs-let-vs-const"><a href="#III-var-vs-let-vs-const" class="headerlink" title="III. var vs let vs const"></a>III. <code>var</code> vs <code>let</code> vs <code>const</code></h2><ul>
<li>使用var声明的变量，其作用域为该语句所在的函数内，且存在变量提升现象；</li>
<li>使用let声明的变量，其作用域为该语句所在的代码块内，不存在变量提升；</li>
<li>使用const声明的是常量，在后面出现的代码中不能再修改该常量的值。但是其作用域为该语句所在的代码块内，因此不同的blcok可以继续定义同一个名字的const</li>
</ul>
<p><strong>var变量的局部作用域是函数级别的：使用区域上至函数头、下至函数尾</strong></p>
<ul>
<li>不同于 C 语言，在 C 中，作用域是块级别的。 JavaScript 中var变量没有块级作用域。</li>
<li>let变量作用域是块级的</li>
<li>js 中，函数中声明的变量在整个函数中都有定义。比如如下代码段，变量 i 和 value 虽然是在 for 循环代码块中被定义，但在代码块外仍可以访问 i 和 value。</li>
<li><p>例子：</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">var</span> value = <span class="string">"hello world"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">console</span>.log(i); <span class="comment">//输出10</span></span><br><span class="line">	<span class="built_in">console</span>.log(value);<span class="comment">//输出hello world</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo();</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="IV-闭包：closure"><a href="#IV-闭包：closure" class="headerlink" title="IV 闭包：closure"></a>IV 闭包：closure</h2><ul>
<li>使内部函数可以访问定义在外部函数中的变量（常见于函数式编程）</li>
<li>假如我们要实现一系列的函数：add10，add20，它们的定义是 int add10(int n)。</li>
<li><p>为此我们构造了一个名为 adder 的构造器，如下：</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> adder = <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> base = x;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> n + base;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">var</span> add10 = adder(<span class="number">10</span>);</span><br><span class="line"><span class="built_in">console</span>.log(add10(<span class="number">5</span>));</span><br><span class="line">    </span><br><span class="line"><span class="keyword">var</span> add20 = adder(<span class="number">20</span>);</span><br><span class="line"><span class="built_in">console</span>.log(add20(<span class="number">5</span>));</span><br></pre></td></tr></table></figure>
</li>
<li><p>每次调用 adder 时，adder 都会返回一个函数给我们。我们传给 adder 的值，会保存在一个名为 base 的变量中。由于返回的函数在其中引用了 base 的值，于是 base 的引用计数被 +1。当返回函数不被垃圾回收时，则 base 也会一直存在。</p>
</li>
<li>我暂时想不出什么实用的例子来，如果想深入理解这块，可以看看这篇 <a href="http://coolshell.cn/articles/6731.html" target="_blank" rel="noopener">http://coolshell.cn/articles/6731.html</a></li>
</ul>
<h2 id="V-Event"><a href="#V-Event" class="headerlink" title="V. Event"></a>V. Event</h2><p>JavaScript 与 HTML 的交互是通过 事件(event) 来处理的</p>
<h2 id="VI-JS创建Object的7种方式"><a href="#VI-JS创建Object的7种方式" class="headerlink" title="VI. JS创建Object的7种方式"></a>VI. JS创建Object的7种方式</h2><p><a href="https://xxxgitone.github.io/2017/06/10/JavaScript%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1%E7%9A%84%E4%B8%83%E7%A7%8D%E6%96%B9%E5%BC%8F/" target="_blank" rel="noopener">https://xxxgitone.github.io/2017/06/10/JavaScript%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1%E7%9A%84%E4%B8%83%E7%A7%8D%E6%96%B9%E5%BC%8F/</a></p>
<ul>
<li><p>方法一：直接使用现有的 Object( )</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> book = <span class="keyword">new</span> <span class="built_in">Object</span>(); <span class="comment">// Create the object</span></span><br><span class="line">book.subject = <span class="string">"Perl"</span>; <span class="comment">// Assign properties to the object</span></span><br><span class="line"></span><br><span class="line">book.author  = <span class="string">"Mohtashim"</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法二：声明自己的 constructor</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Book</span>(<span class="params">title, author</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.title = title; </span><br><span class="line">    <span class="keyword">this</span>.author = author;</span><br><span class="line">	  <span class="keyword">this</span>.addPrice = addPrice; <span class="comment">//  Assign that method as property.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addPrice</span>(<span class="params">amount</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.price = amount; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> book1 = <span class="keyword">new</span> Book(‘Book Name’, ‘Aride’);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="VII-with-关键字"><a href="#VII-with-关键字" class="headerlink" title="VII. with 关键字"></a>VII. with 关键字</h2><ul>
<li>被用来作为用于引用一个对象的属性或方法的一种速记。</li>
<li><p>对象被指定成 with 关键字的参数，进而成为后面语句块的默认对象。这个对象的下的属性和方法可以不指定对象名而直接使用。</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> (object)&#123;</span><br><span class="line">   properties used without the object name and dot</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>例子：</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addPrice</span>(<span class="params">amount</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">with</span>(<span class="keyword">this</span>)&#123;</span><br><span class="line">       price = amount; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">book</span>(<span class="params">title, author</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.title = title; </span><br><span class="line">        <span class="keyword">this</span>.author  = author;</span><br><span class="line">        <span class="keyword">this</span>.price = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.addPrice = addPrice; <span class="comment">// Assign that method as property.</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="IX-JavaScript-Native-对象（6个）"><a href="#IX-JavaScript-Native-对象（6个）" class="headerlink" title="IX. JavaScript Native 对象（6个）"></a>IX. JavaScript Native 对象（6个）</h2><ul>
<li>Number Object</li>
<li>Boolean Object</li>
<li>String Object</li>
<li>Array Object</li>
<li>Date Object</li>
<li>Math Object</li>
<li>RegExp Object</li>
</ul>
<h2 id="X-func-…"><a href="#X-func-…" class="headerlink" title="X. ( func(){…} )( )"></a>X. ( func(){…} )( )</h2><ul>
<li><p>Putting () after something that evaluates to a function will call that function. So, hi() calls the function hi. Assuming hi returns a function then hi()() will call that function. Example:</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hi</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="string">"hello there"</span>;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> returnedFunc = hi();  <span class="comment">// so returnedFunc equals function()&#123;return "hello there";&#125;;</span></span><br><span class="line"><span class="keyword">var</span> msg = hi()();         <span class="comment">// so msg now has a value of "hello there"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>If hi() doesn’t return a function, then hi()() will produce an error, similar to having typed something like “not a function”(); or 1232();.</p>
</li>
</ul>
<h2 id="XI-Array-map"><a href="#XI-Array-map" class="headerlink" title="XI. Array.map( )"></a>XI. Array.map( )</h2><p>creates a new array with the results of calling a function for every array element</p>
   <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> names = [<span class="string">'Alice'</span>, <span class="string">'Emily'</span>, <span class="string">'Kate'</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">functionName</span>(<span class="params"> var </span>)</span>&#123;  <span class="keyword">var</span> = <span class="keyword">var</span> + <span class="string">'!'</span> ; &#125;</span><br><span class="line"><span class="keyword">var</span> names.map(functionName);</span><br></pre></td></tr></table></figure>
<h2 id="XII-this-and-bind"><a href="#XII-this-and-bind" class="headerlink" title="XII. this and bind()"></a>XII. <code>this</code> and <code>bind()</code></h2><ol>
<li><code>this</code> 的问题：谁调用的函数，this就指向谁<strong>（一定看link）</strong><br><strong>link</strong>：<a href="https://github.com/alsotang/node-lessons/tree/master/lesson11" target="_blank" rel="noopener">https://github.com/alsotang/node-lessons/tree/master/lesson11</a></li>
</ol>
<ol start="2">
<li><p>bind( ): 指明 this 所指的对象</p>
<ul>
<li><p>JS背景： </p>
<ul>
<li>function也是一个对象object，因此也有自己的method <code>bind()</code>, <code>apply()</code>, <code>call()</code></li>
<li>func( ) 的调用，实际是隐式的对象调用: retrieveX(); 是在全局scope调用，因此相当于window.func( ) </li>
</ul>
</li>
<li><p>bind(obj)方法实际创建了一个新函数，将参数obj绑定到原函数之上，使this有了新的实体【 this:灵魂  — obj:实体 】<br>“The bind() method creates a new function that, when called, has its this keyword set to the provided value,”</p>
</li>
<li><p>例子</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="built_in">module</span> = &#123;</span><br><span class="line">  x: <span class="number">42</span>,</span><br><span class="line">  getX: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.x;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> retrieveX = <span class="built_in">module</span>.getX;</span><br><span class="line"><span class="built_in">console</span>.log(retrieveX()); <span class="comment">// The function gets invoked at the global scope</span></span><br><span class="line"><span class="comment">// expected output: undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> boundGetX = retrieveX.bind(<span class="built_in">module</span>);</span><br><span class="line"><span class="built_in">console</span>.log(boundGetX());</span><br><span class="line"><span class="comment">// expected output: 42</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>bind实现函数借用（相当于Java“继承父类的方法”）</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1-----user 对象</span></span><br><span class="line"><span class="keyword">var</span> user = &#123;</span><br><span class="line">    data    :[</span><br><span class="line">        &#123;<span class="attr">name</span>:<span class="string">"T. Woods"</span>, <span class="attr">age</span>:<span class="number">37</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">name</span>:<span class="string">"P. Mickelson"</span>, <span class="attr">age</span>:<span class="number">43</span>&#125;</span><br><span class="line">    ],</span><br><span class="line">    </span><br><span class="line">    showData: <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.data[<span class="number">0</span>].name + <span class="string">" "</span> + <span class="keyword">this</span>.data[<span class="number">0</span>].age);</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"> <span class="comment">// 2-----cars 对象</span></span><br><span class="line"><span class="keyword">var</span> cars = &#123;</span><br><span class="line">    data:[</span><br><span class="line">        &#123;<span class="attr">name</span>:<span class="string">"Honda Accord"</span>, <span class="attr">age</span>:<span class="number">14</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">name</span>:<span class="string">"Tesla Model S"</span>, <span class="attr">age</span>:<span class="number">2</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">​</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="comment">// 我们从之前定义的 user 对象借用 showData 方法</span></span><br><span class="line"><span class="comment">// 这里我们将 user.showData 方法绑定到刚刚新建的 cars 对象上​</span></span><br><span class="line">cars.showData = user.showData.bind(cars);</span><br><span class="line">cars.showData(); <span class="comment">// Honda Accord 14​</span></span><br><span class="line">​</span><br></pre></td></tr></table></figure>
</li>
<li><p>user、cars是两个object。</p>
</li>
<li>user有自己的method user.showData</li>
<li>user.showData.bind(cars); bind( ) 会将showData这个function生成一个新的函数，函数体中的this编程了cars object，从而实现的函数借用的目的</li>
<li>弊端：如果cars中也有自己showData method，使用bind有可能将自己的method覆盖；好的方式是使用 call／apply</li>
</ul>
</li>
</ol>
<h2 id="XIII-call-amp-apply"><a href="#XIII-call-amp-apply" class="headerlink" title="XIII. call() &amp; apply()"></a>XIII. <code>call()</code> &amp; <code>apply()</code></h2><ul>
<li>JS背景： <ol>
<li>function也是一个对象object，因此也有自己的method <code>bind()</code>, <code>apply()</code>, <code>call()</code></li>
<li>fun( ) 的调用，实际是隐式的对象调用: retrieveX(); 是在全局scope调用，因此相当于window.retrieveX( ) </li>
</ol>
</li>
<li>类似Java Interface，很多object都可以使用这个function</li>
<li>call() 方法调用一个函数, 参数重指定的this的指向值和以及函数对应的传入参数</li>
<li><p>例子：</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Product</span>(<span class="params">name, price</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.price = price;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Food</span>(<span class="params">name, price</span>) </span>&#123;</span><br><span class="line">  Product.call(<span class="keyword">this</span>, name, price);</span><br><span class="line">  <span class="keyword">this</span>.category = <span class="string">'food'</span>;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> Food(<span class="string">'cheese'</span>, <span class="number">5</span>).name);</span><br><span class="line"><span class="comment">// expected output: "cheese"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在下面的例子中，当调用greet方法的时候，该方法的this值会绑定到i对象。</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> reply = [<span class="keyword">this</span>.person, <span class="string">'Is An Awesome'</span>, <span class="keyword">this</span>.role].join(<span class="string">' '</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(reply);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">var</span> i = &#123;</span><br><span class="line">  person: <span class="string">'Douglas Crockford'</span>, <span class="attr">role</span>: <span class="string">'Javascript Developer'</span></span><br><span class="line">&#125;;</span><br><span class="line">    </span><br><span class="line">greet.call(i); <span class="comment">// Douglas Crockford Is An Awesome Javascript Developer</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="XIV-CommonJS：是一个规范"><a href="#XIV-CommonJS：是一个规范" class="headerlink" title="XIV. CommonJS：是一个规范"></a>XIV. CommonJS：是一个规范</h2><ul>
<li>CommonJS 是以在浏览器环境之外构建 JavaScript 生态系统为目标而产生的项目，比如在服务器和桌面环境中。</li>
<li>CommonJS 规范是为了解决 JavaScript 的作用域问题而定义的模块形式，可以使每个模块它自身的命名空间中执行。该规范的主要内容是</li>
<li>模块必须通过 module.exports 导出对外的变量或接口，通过 require() 来导入其他模块的输出到当前模块作用域中。</li>
<li><p>一个直观的例子：</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// moduleA.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params"> value </span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> value * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// moduleB.js</span></span><br><span class="line"><span class="keyword">var</span> multiplyBy2 = <span class="built_in">require</span>(<span class="string">'./moduleA'</span>);</span><br><span class="line"><span class="keyword">var</span> result = multiplyBy2(<span class="number">4</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="XV-CommonJS-import-vs-export"><a href="#XV-CommonJS-import-vs-export" class="headerlink" title="XV. CommonJS: import vs export"></a>XV. CommonJS: <code>import</code> vs <code>export</code></h2><ul>
<li><a href="http://es6.ruanyifeng.com/#docs/module#export-default-%E5%91%BD%E4%BB%A4" target="_blank" rel="noopener">http://es6.ruanyifeng.com/#docs/module#export-default-%E5%91%BD%E4%BB%A4</a></li>
<li><p><strong>正常情况：二者都要加花括号  { }</strong></p>
<ul>
<li>模块功能主要由两个命令构成：export和import。export命令用于规定模块的对外接口，import命令用于输入其他模块提供的功能。</li>
<li>一个模块就是一个独立的文件。该文件内部的所有变量，外部无法获取。如果你希望外部能够读取模块内部的某个变量，就必须使用export关键字输出该变量。下面是一个 JS 文件，里面使用export命令输出变量。</li>
<li><p>例子</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// circle.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">area</span>(<span class="params">radius</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.PI * radius * radius;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">circumference</span>(<span class="params">radius</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">2</span> * <span class="built_in">Math</span>.PI * radius;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">现在，加载这个模块。</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; area, circumference &#125; <span class="keyword">from</span> <span class="string">'./circle'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'圆面积：'</span> + area(<span class="number">4</span>));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'圆周长：'</span> + circumference(<span class="number">14</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">上面写法是逐一指定要加载的方法，整体加载的写法如下。</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> circle <span class="keyword">from</span> <span class="string">'./circle'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'圆面积：'</span> + circle.area(<span class="number">4</span>));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'圆周长：'</span> + circle.circumference(<span class="number">14</span>));</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><strong>default情况：不需要花括号 { }</strong></p>
<ul>
<li><p>使用情景：</p>
<ul>
<li>从前面的例子可以看出，使用import命令的时候，用户需要知道所要加载的变量名或函数名，否则无法加载。但是，用户肯定希望快速上手，未必愿意阅读文档，去了解模块有哪些属性和方法。</li>
<li>为了给用户提供方便，让他们不用阅读文档就能加载模块，就要用到export default命令，为模块指定默认输出。</li>
<li>export default命令用于指定模块的默认输出。显然，一个模块只能有一个默认输出，因此export default命令只能使用一次。所以，import命令后面才不用加大括号，因为只可能唯一对应export default命令。</li>
<li>本质上，export default就是输出一个叫做default的变量或方法，然后系统允许你为它取任意名字。所以，下面的写法是有效的。</li>
<li><p>例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// modules.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x * y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> &#123;add <span class="keyword">as</span> <span class="keyword">default</span>&#125;;</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="comment">// export default add;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> foo &#125; <span class="keyword">from</span> <span class="string">'modules'</span>;</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="comment">// import foo from 'modules';</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>比较： 下面比较一下默认输出和正常输出</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一组</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">crc32</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 输出</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> crc32 <span class="keyword">from</span> <span class="string">'crc32'</span>; <span class="comment">// 输入</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二组</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">crc32</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 输出</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;crc32&#125; <span class="keyword">from</span> <span class="string">'crc32'</span>; <span class="comment">// 输入"</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="XVI-Spread-Operator展开运算符"><a href="#XVI-Spread-Operator展开运算符" class="headerlink" title="XVI. ...:Spread Operator展开运算符"></a>XVI. <code>...</code>:Spread Operator展开运算符</h2><p><a href="https://blog.fundebug.com/2017/07/19/master_object_spread_operator/" target="_blank" rel="noopener">https://blog.fundebug.com/2017/07/19/master_object_spread_operator/</a></p>
<ul>
<li><p>展开运算符将所有可枚举的属性从一个对象展开到另一个对象去。一个例子：</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj1 = &#123; <span class="attr">c</span>: <span class="number">3</span>, <span class="attr">d</span>: <span class="number">4</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> obj2 = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, ...obj1 &#125;;</span><br><span class="line"><span class="built_in">console</span>.log(obj2); <span class="comment">//&#123; a: 1, b: 2, c: 3, d: 4 &#125;</span></span><br><span class="line">                   <span class="comment">//obj1的所有属性被展开到obj2中去。</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>应用场景1：deep copy</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">a</span>: <span class="number">123</span>, <span class="attr">b</span>: <span class="number">456</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> objCopy = &#123; ...obj &#125;;</span><br><span class="line"><span class="built_in">console</span>.log(objCopy); </span><br><span class="line"></span><br><span class="line"><span class="comment">// &#123; a: 123, b: 456 &#125;</span></span><br><span class="line"><span class="comment">// 注意： 不会递归地深度拷贝所有属性</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>应用场景2：合并多个对象</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj1 = &#123; <span class="attr">a</span>: <span class="number">111</span>, <span class="attr">b</span>: <span class="number">222</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> obj2 = &#123; <span class="attr">c</span>: <span class="number">333</span>, <span class="attr">d</span>: <span class="number">444</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> merged = &#123; ...obj1, ...obj2 &#125;;</span><br><span class="line"><span class="built_in">console</span>.log(merged);</span><br><span class="line"></span><br><span class="line"><span class="comment">// &#123; a: 111, b: 222, c: 333, d: 444 &#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Template-literals"><a href="#Template-literals" class="headerlink" title="Template literals: `     `"></a>Template literals: `     `</h2><ul>
<li>处理字符串中变量:使用 <code>{ }</code>包含起来</li>
<li>use the ` around a series of characters, which are interpreted as a string literal; </li>
<li><p>But any expressions of the form ${..} are parsed and evaluated inline immediately.</p>
</li>
<li><p>为什么用它？—简洁</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'Fifteen is '</span> + (a + b) + <span class="string">' and \n not '</span> + (<span class="number">2</span> * a + b) + <span class="string">'.'</span>);</span><br><span class="line"><span class="comment">// "Fifteen is 15 and</span></span><br><span class="line"><span class="comment">// not 20."</span></span><br><span class="line"></span><br><span class="line">----------------------------------</span><br><span class="line">控制打印更简单，不用\n，直接断行。如下： </span><br><span class="line">----------------------------------</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`Fifteen is <span class="subst">$&#123;a + b&#125;</span> and</span></span><br><span class="line"><span class="string">not <span class="subst">$&#123;<span class="number">2</span> * a + b&#125;</span>.`</span>);</span><br><span class="line"><span class="comment">// "Fifteen is 15 and</span></span><br><span class="line"><span class="comment">// not 20.""</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="XVII-Special-Variables"><a href="#XVII-Special-Variables" class="headerlink" title="XVII. Special Variables $, $$, _"></a>XVII. Special Variables <code>$</code>, <code>$$</code>, <code>_</code></h2><ul>
<li><strong>Using <code>$</code></strong><ul>
<li>For instance, the $ variable has been made popular by several JavaScript libraries, most notably jQuery. You can use it to alias operations that are commonly performed, such as the following (1):</li>
<li>var $ = document.getElementById;</li>
<li>var myElement = $(‘targetElement’);</li>
<li>If you declare this variable outside of a function it will be a global variable and will compete with libraries that use the same global variable, so it’s probably best not to use it.</li>
<li>Interestingly, originally the dollar sign $ was originally intended for ‘mechanically generated code’ (2), but as the usage of the symbol has become popular for other purposes, it looks like the latest version of JavaScript (ECMAScript 5th edition) now officially ‘oks’ its use:</li>
<li>This standard specifies specific character additions: The dollar sign ($) and the underscore (_) are permitted anywhere in an IdentifierName.</li>
</ul>
</li>
<li><strong>Using <code>$$</code></strong><ul>
<li>Some have come up with the solution of simply using two or more $$ symbols in order to distinguish the variable from libraries that just use a single $:</li>
<li>var $$ = document.getElementById;</li>
<li>var myElement = $$(‘targetElement’);</li>
</ul>
</li>
<li><strong>Using <code>_</code></strong><ul>
<li>You will find that you can use the underscore _ in the same way to alias variables and functions:</li>
<li>var _ = document.getElementById;</li>
<li>var myElement = _(‘targetElement’);</li>
</ul>
</li>
<li><strong>Other symbols</strong><ul>
<li>If you’re really getting adventurous, you can even try using other symbols such as square root √, which seems to work just fine, just as $ and _ above. The</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/sea.jpg"
                alt="Mingkai Cao" />
            
              <p class="site-author-name" itemprop="name">Mingkai Cao</p>
              <p class="site-description motion-element" itemprop="description">Jack of all trades, master of one</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">24</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">5</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">18</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/caomingkai" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:mingkaic@usc.edu" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate"> 
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mingkai Cao</span>

  

  
</div>




  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Gemini</a> v6.0.6</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="Total Visitors">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="Total Views">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.6"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.6"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.0.6"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.0.6"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.6"></script>



  



	





  





  








  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  
  
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>

  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick';
    guest = guest.split(',').filter(function (item) {
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'hG8fgggWL7hK1jsXsRoVCNWv-MdYXbMMI',
        appKey: 'VRAYsgwdkRyyb8bAFQ5uii6o',
        placeholder: 'Any comment?',
        avatar:'',
        guest_info:guest,
        pageSize:'10' || 10,
    });
    // 新增以下代码即可，可以移除.info下所有子节点
    var infoEle = document.querySelector('#comments .info');
    if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0){
      infoEle.childNodes.forEach(function(item) {
        item.parentNode.removeChild(item);
      });
    }


  </script>



  





  

  

  

  

  
  

  

  

  

  


<style>
    #comments .vempty{
        display: none;
    }
</style>

</body>
</html>
